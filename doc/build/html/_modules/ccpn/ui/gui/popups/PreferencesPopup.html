
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ccpn.ui.gui.popups.PreferencesPopup &#8212; Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/classic.css" />
    
    <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ccpn.ui.gui.popups.PreferencesPopup</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ccpn.ui.gui.popups.PreferencesPopup</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module Documentation here</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Licence, Reference and Credits</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright (C) CCPN project (https://www.ccpn.ac.uk) 2014 - 2022&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Ed Brooksbank, Joanna Fox, Victoria A Higman, Luca Mureddu, Eliza Płoskoń&quot;</span><span class="p">,</span>
               <span class="s2">&quot;Timothy J Ragan, Brian O Smith, Gary S Thompson &amp; Geerten W Vuister&quot;</span><span class="p">)</span>
<span class="n">__licence__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;CCPN licence. See https://ccpn.ac.uk/software/licensing/&quot;</span><span class="p">)</span>
<span class="n">__reference__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Skinner, S.P., Fogh, R.H., Boucher, W., Ragan, T.J., Mureddu, L.G., &amp; Vuister, G.W.&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;CcpNmr AnalysisAssign: a flexible platform for integrated NMR analysis&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;J.Biomol.Nmr (2016), 66, 111-124, http://doi.org/10.1007/s10858-016-0060-y&quot;</span><span class="p">)</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Last code modification</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__modifiedBy__</span> <span class="o">=</span> <span class="s2">&quot;$modifiedBy: Ed Brooksbank $&quot;</span>
<span class="n">__dateModified__</span> <span class="o">=</span> <span class="s2">&quot;$dateModified: 2022-06-17 13:42:00 +0100 (Fri, June 17, 2022) $&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: 3.1.0 $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Created</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;$Author: CCPN $&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;$Date: 2017-03-30 11:28:58 +0100 (Thu, March 30, 2017) $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Start of code</span>
<span class="c1">#=========================================================================================</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span><span class="p">,</span> <span class="n">copy</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Label</span> <span class="kn">import</span> <span class="n">Label</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Frame</span> <span class="kn">import</span> <span class="n">Frame</span><span class="p">,</span> <span class="n">ScrollableFrame</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Button</span> <span class="kn">import</span> <span class="n">Button</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.LineEdit</span> <span class="kn">import</span> <span class="n">LineEdit</span><span class="p">,</span> <span class="n">PasswordEdit</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.DoubleSpinbox</span> <span class="kn">import</span> <span class="n">DoubleSpinbox</span><span class="p">,</span> <span class="n">ScientificDoubleSpinBox</span>
<span class="c1"># from ccpn.ui.gui.widgets.MessageDialog import showYesNo</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Spinbox</span> <span class="kn">import</span> <span class="n">Spinbox</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.PulldownList</span> <span class="kn">import</span> <span class="n">PulldownList</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.CheckBox</span> <span class="kn">import</span> <span class="n">CheckBox</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.RadioButtons</span> <span class="kn">import</span> <span class="n">RadioButtons</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Slider</span> <span class="kn">import</span> <span class="n">Slider</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.guiSettings</span> <span class="kn">import</span> <span class="n">COLOUR_SCHEMES</span><span class="p">,</span> <span class="n">getColours</span><span class="p">,</span> <span class="n">DIVIDER</span><span class="p">,</span> <span class="n">setColourScheme</span><span class="p">,</span> <span class="n">FONTLIST</span><span class="p">,</span> <span class="n">ZPlaneNavigationModes</span>
<span class="kn">from</span> <span class="nn">ccpn.framework.Translation</span> <span class="kn">import</span> <span class="n">languages</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.popups.Dialog</span> <span class="kn">import</span> <span class="n">handleDialogApply</span><span class="p">,</span> <span class="n">_verifyPopupApply</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets</span> <span class="kn">import</span> <span class="n">MessageDialog</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Tabs</span> <span class="kn">import</span> <span class="n">Tabs</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.HLine</span> <span class="kn">import</span> <span class="n">HLine</span><span class="p">,</span> <span class="n">LabeledHLine</span>
<span class="kn">from</span> <span class="nn">ccpn.util.Logging</span> <span class="kn">import</span> <span class="n">getLogger</span>
<span class="kn">from</span> <span class="nn">ccpn.util.Colour</span> <span class="kn">import</span> <span class="n">spectrumColours</span><span class="p">,</span> <span class="n">addNewColour</span><span class="p">,</span> <span class="n">fillColourPulldown</span><span class="p">,</span> <span class="n">colourNameNoSpace</span><span class="p">,</span> <span class="n">_setColourPulldown</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.ColourDialog</span> <span class="kn">import</span> <span class="n">ColourDialog</span>
<span class="kn">from</span> <span class="nn">ccpn.core.PeakList</span> <span class="kn">import</span> <span class="n">GAUSSIANMETHOD</span><span class="p">,</span> <span class="n">PARABOLICMETHOD</span>
<span class="kn">from</span> <span class="nn">ccpn.core.MultipletList</span> <span class="kn">import</span> <span class="n">MULTIPLETAVERAGINGTYPES</span>
<span class="kn">from</span> <span class="nn">ccpn.util.UserPreferences</span> <span class="kn">import</span> <span class="n">UserPreferences</span>
<span class="c1"># from ccpn.util.Common import camelCaseToString</span>
<span class="kn">from</span> <span class="nn">ccpn.util.Path</span> <span class="kn">import</span> <span class="n">aPath</span>
<span class="kn">from</span> <span class="nn">ccpn.util.Constants</span> <span class="kn">import</span> <span class="n">AXISUNITS</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.GuiPath</span> <span class="kn">import</span> <span class="n">PathEdit</span><span class="p">,</span> <span class="n">VALIDFILE</span>
<span class="c1"># from ccpn.ui.gui.popups.ValidateSpectraPopup import ValidateSpectraForPreferences</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.popups.Dialog</span> <span class="kn">import</span> <span class="n">CcpnDialogMainWidget</span>
<span class="kn">from</span> <span class="nn">ccpn.core.lib.ContextManagers</span> <span class="kn">import</span> <span class="n">queueStateChange</span><span class="p">,</span> <span class="n">undoStackBlocking</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.FileDialog</span> <span class="kn">import</span> <span class="n">SpectrumFileDialog</span><span class="p">,</span> <span class="n">ProjectFileDialog</span><span class="p">,</span> <span class="n">AuxiliaryFileDialog</span><span class="p">,</span> \
    <span class="n">LayoutsFileDialog</span><span class="p">,</span> <span class="n">MacrosFileDialog</span><span class="p">,</span> <span class="n">PluginsFileDialog</span><span class="p">,</span> <span class="n">PipelineFileDialog</span><span class="p">,</span> <span class="n">ExecutablesFileDialog</span><span class="p">,</span> \
    <span class="n">ProjectSaveFileDialog</span>
<span class="kn">from</span> <span class="nn">ccpn.framework.lib.pipeline.PipesLoader</span> <span class="kn">import</span> <span class="n">_fetchUserPipesPath</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.ChangeStateHandler</span> <span class="kn">import</span> <span class="n">changeState</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Font</span> <span class="kn">import</span> <span class="n">DEFAULTFONTNAME</span><span class="p">,</span> <span class="n">DEFAULTFONTSIZE</span><span class="p">,</span> <span class="n">DEFAULTFONTREGULAR</span><span class="p">,</span> <span class="n">getFontHeight</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.OpenGL.CcpnOpenGLGlobal</span> <span class="kn">import</span> <span class="n">GLFONT_DEFAULTSIZE</span><span class="p">,</span> <span class="n">_OLDGLFONT_SIZES</span>


<span class="n">PEAKFITTINGDEFAULTS</span> <span class="o">=</span> <span class="p">[</span><span class="n">PARABOLICMETHOD</span><span class="p">,</span> <span class="n">GAUSSIANMETHOD</span><span class="p">]</span>

<span class="c1"># FIXME separate pure GUI to project/preferences properties</span>
<span class="c1"># The code sets Gui Parameters assuming that  Preference is not None and has a bunch of attributes.</span>


<span class="n">PulldownListsMinimumWidth</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">LineEditsMinimumWidth</span> <span class="o">=</span> <span class="mi">195</span>
<span class="n">NotImplementedTipText</span> <span class="o">=</span> <span class="s1">&#39;This option has not been implemented yet&#39;</span>
<span class="n">DEFAULTSPACING</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">TABMARGINS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># l, t, r, b</span>
<span class="n">ZEROMARGINS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># l, t, r, b</span>

<span class="n">FONTLABELFORMAT</span> <span class="o">=</span> <span class="s1">&#39;_fontLabel</span><span class="si">{}</span><span class="s1">&#39;</span>
<span class="n">FONTDATAFORMAT</span> <span class="o">=</span> <span class="s1">&#39;_fontData</span><span class="si">{}</span><span class="s1">&#39;</span>
<span class="n">FONTSTRING</span> <span class="o">=</span> <span class="s1">&#39;_fontString&#39;</span>
<span class="n">FONTPREFS</span> <span class="o">=</span> <span class="s1">&#39;font</span><span class="si">{}</span><span class="s1">&#39;</span>


<span class="k">def</span> <span class="nf">_updateSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newPrefs</span><span class="p">,</span> <span class="n">updateColourScheme</span><span class="p">,</span> <span class="n">updateSpectrumDisplays</span><span class="p">,</span> <span class="n">userWorkingPath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.OpenGL.CcpnOpenGL</span> <span class="kn">import</span> <span class="n">GLNotifier</span>

    <span class="c1"># update the preferences, but keep in place</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">newPrefs</span><span class="p">)</span>

    <span class="c1"># application preferences updated so re-save</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_savePreferences</span><span class="p">()</span>

    <span class="c1"># update the current userWorkingPath in the active file dialogs</span>
    <span class="k">if</span> <span class="n">userWorkingPath</span><span class="p">:</span>
        <span class="n">_dialog</span> <span class="o">=</span> <span class="n">ProjectFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
        <span class="n">_dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">userWorkingPath</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>
        <span class="n">_dialog</span> <span class="o">=</span> <span class="n">ProjectSaveFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
        <span class="n">_dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">userWorkingPath</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_updateDisplay</span><span class="p">(</span><span class="n">updateColourScheme</span><span class="p">,</span> <span class="n">updateSpectrumDisplays</span><span class="p">)</span>

    <span class="n">GLSignals</span> <span class="o">=</span> <span class="n">GLNotifier</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">GLSignals</span><span class="o">.</span><span class="n">emitPaintEvent</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_refreshGLItems</span><span class="p">():</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Label</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convenience routine to make a Label with uniform settings</span>
<span class="sd">    :return Label instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;hAlign&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;margins&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">label</span>


<span class="k">def</span> <span class="nf">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience routine to make a horizontal Line, optionally with text and with uniform settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;gridSpan&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;colour&#39;</span><span class="p">,</span> <span class="n">getColours</span><span class="p">()[</span><span class="n">DIVIDER</span><span class="p">])</span>
    <span class="n">kwds</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">HLine</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">LabeledHLine</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="k">def</span> <span class="nf">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">toolTip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience routine to make a row with a label and a checkbox</span>
<span class="sd">    :return CheckBox instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_label</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="n">_checkBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">_checkBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">toolTip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">toolTip</span><span class="p">)</span>
        <span class="n">_checkBox</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">toolTip</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_checkBox</span>


<span class="k">def</span> <span class="nf">_makeButton</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">toolTip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">buttonText</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convenience routine to make a row with a label and a button</span>
<span class="sd">    :return Button instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_label</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
    <span class="n">_button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">buttonText</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;minimal&#39;</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">_button</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">toolTip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">toolTip</span><span class="p">)</span>
        <span class="n">_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">toolTip</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_button</span>


<div class="viewcode-block" id="PreferencesPopup"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup">[docs]</a><span class="k">class</span> <span class="nc">PreferencesPopup</span><span class="p">(</span><span class="n">CcpnDialogMainWidget</span><span class="p">):</span>
    <span class="n">FIXEDHEIGHT</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">FIXEDWIDTH</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mainWindow</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preferences</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Preferences&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">windowTitle</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span> <span class="o">=</span> <span class="n">mainWindow</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">application</span> <span class="o">=</span> <span class="n">mainWindow</span><span class="o">.</span><span class="n">application</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">mainWindow</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">project</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">application</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">:</span>
            <span class="n">MessageDialog</span><span class="o">.</span><span class="n">showWarning</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s1">&#39;No project loaded&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># copy the current preferences</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">preferences</span><span class="p">)</span>

        <span class="c1"># grab the class with the preferences methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userPreferences</span> <span class="o">=</span> <span class="n">UserPreferences</span><span class="p">(</span><span class="n">readPreferences</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># store the original values - needs to be recursive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lastPrefs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setTabs</span><span class="p">()</span>

        <span class="c1"># enable the buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOkButton</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_okClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setApplyButton</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_applyClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCancelButton</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_cancelClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setHelpButton</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_helpClicked</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRevertButton</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_revertClicked</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">CcpnDialogMainWidget</span><span class="o">.</span><span class="n">CANCELBUTTON</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>

        <span class="n">tabs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tab</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">150</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tab</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">for</span> <span class="n">tab</span> <span class="ow">in</span> <span class="n">tabs</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="mi">800</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>

        <span class="c1"># keep a backup of the working paths in the dialogs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempDialog</span> <span class="o">=</span> <span class="n">ProjectFileDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempDialog</span><span class="o">.</span><span class="n">_storePaths</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__postInit__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_okButton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">OKBUTTON</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applyButton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revertButton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getChangeState</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the change state from the _changes dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">applyState</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">revertState</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">allChanges</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">changeState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allChanges</span><span class="p">,</span> <span class="n">applyState</span><span class="p">,</span> <span class="n">revertState</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_okButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applyButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_revertButton</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">)</span>

<div class="viewcode-block" id="PreferencesPopup.getActiveTabList"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup.getActiveTabList">[docs]</a>    <span class="k">def</span> <span class="nf">getActiveTabList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the list of active tabs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">widget</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">count</span><span class="p">()))</span></div>

    <span class="k">def</span> <span class="nf">_revertClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Revert button signal comes here</span>
<span class="sd">        Revert (roll-back) the state of the project to before the popup was opened</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Reset preferences to previous state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_undo</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">undos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_undo</span><span class="o">.</span><span class="n">undo</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_savePreferences</span><span class="p">()</span>

        <span class="c1"># retrieve the original preferences</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lastPrefs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_okButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applyButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revertButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_updateSpectrumDisplays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">display</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">spectrumDisplays</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">strip</span> <span class="ow">in</span> <span class="n">display</span><span class="o">.</span><span class="n">strips</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">strip</span><span class="o">.</span><span class="n">blockWidgetSignals</span><span class="p">():</span>
                    <span class="c1"># NOTE:ED - should only set those values that have changed</span>

                    <span class="n">strip</span><span class="o">.</span><span class="n">symbolLabelling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">annotationType</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">symbolType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolType</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">symbolSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolSizePixel</span>

                    <span class="n">strip</span><span class="o">.</span><span class="n">symbolThickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolThickness</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">gridVisible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showGrid</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">contourThickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">contourThickness</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">crosshairVisible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showCrosshair</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">sideBandsVisible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showSideBands</span>

                    <span class="n">strip</span><span class="o">.</span><span class="n">spectrumBordersVisible</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showSpectrumBorder</span>

                    <span class="n">strip</span><span class="o">.</span><span class="n">aliasEnabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasEnabled</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">aliasShade</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasShade</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">aliasLabelsEnabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasLabelsEnabled</span>

                    <span class="n">strip</span><span class="o">.</span><span class="n">peakLabelsEnabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakLabelsEnabled</span>
                    <span class="n">strip</span><span class="o">.</span><span class="n">multipletLabelsEnabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">multipletLabelsEnabled</span>

                <span class="n">strip</span><span class="o">.</span><span class="n">_frameGuide</span><span class="o">.</span><span class="n">resetColourTheme</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_updateDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updateColourScheme</span><span class="p">,</span> <span class="n">updateSpectrumDisplays</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">updateColourScheme</span><span class="p">:</span>
            <span class="c1"># change the colour theme</span>
            <span class="n">setColourScheme</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_correctColours</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">updateSpectrumDisplays</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updateSpectrumDisplays</span><span class="p">()</span>

        <span class="c1"># colour theme has changed - flag displays to update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateGui</span><span class="p">(</span><span class="n">updateSpectrumDisplays</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_applyChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The apply button has been clicked</span>
<span class="sd">        Define an undo block for setting the properties of the object</span>
<span class="sd">        If there is an error setting any values then generate an error message</span>
<span class="sd">          If anything has been added to the undo queue then remove it with application.undo()</span>
<span class="sd">          repopulate the popup widgets</span>

<span class="sd">        This is controlled by a series of dicts that contain change functions - operations that are scheduled</span>
<span class="sd">        by changing items in the popup. These functions are executed when the Apply or OK buttons are clicked</span>

<span class="sd">        Return True unless any errors occurred</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># this will apply the immediate guiChanges with an undo block</span>
        <span class="c1"># applyToSDs = self.preferences.general.applyToSpectrumDisplays</span>

        <span class="c1"># need to get from the checkBox, otherwise out-of-sync</span>
        <span class="n">applyToSDs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useApplyToSpectrumDisplaysBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

        <span class="n">allChanges</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">allChanges</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># handle clicking of the Apply/OK button</span>
        <span class="k">with</span> <span class="n">handleDialogApply</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

            <span class="c1"># remember the last state before applying changes</span>
            <span class="n">lastPrefs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="p">)</span>

            <span class="c1"># apply all changes - only to self.preferences</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applyAllChanges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">)</span>

            <span class="c1"># check whether the colourScheme needs updating</span>
            <span class="n">_changeColour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span> <span class="o">!=</span> <span class="n">lastPrefs</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span>
            <span class="n">_changeUserWorkingPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span> <span class="o">!=</span> <span class="n">lastPrefs</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span>

            <span class="c1"># read the last working path set in the file dialogs</span>
            <span class="n">_dialog</span> <span class="o">=</span> <span class="n">ProjectFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">_lastUserWorkingPath</span> <span class="o">=</span> <span class="n">_dialog</span><span class="o">.</span><span class="n">initialPath</span><span class="o">.</span><span class="n">asString</span><span class="p">()</span>  <span class="c1"># an aPath</span>

            <span class="n">_newUserWorkingPath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span>

            <span class="c1"># add an undo item to update settings</span>
            <span class="k">with</span> <span class="n">undoStackBlocking</span><span class="p">()</span> <span class="k">as</span> <span class="n">addUndoItem</span><span class="p">:</span>
                <span class="n">addUndoItem</span><span class="p">(</span><span class="n">undo</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">_updateSettings</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">lastPrefs</span><span class="p">,</span> <span class="n">_changeColour</span><span class="p">,</span> <span class="n">applyToSDs</span><span class="p">,</span>
                                         <span class="n">_lastUserWorkingPath</span> <span class="k">if</span> <span class="n">_changeUserWorkingPath</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>

            <span class="c1"># remember the new state - between addUndoItems because it may append to the undo stack</span>
            <span class="n">newPrefs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="p">)</span>
            <span class="n">_updateSettings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newPrefs</span><span class="p">,</span> <span class="n">_changeColour</span><span class="p">,</span> <span class="n">applyToSDs</span><span class="p">,</span>
                            <span class="n">_newUserWorkingPath</span> <span class="k">if</span> <span class="n">_changeUserWorkingPath</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># add a redo item to update settings</span>
            <span class="k">with</span> <span class="n">undoStackBlocking</span><span class="p">()</span> <span class="k">as</span> <span class="n">addUndoItem</span><span class="p">:</span>
                <span class="n">addUndoItem</span><span class="p">(</span><span class="n">redo</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">_updateSettings</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">newPrefs</span><span class="p">,</span> <span class="n">_changeColour</span><span class="p">,</span> <span class="n">applyToSDs</span><span class="p">,</span>
                                         <span class="n">_newUserWorkingPath</span> <span class="k">if</span> <span class="n">_changeUserWorkingPath</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>

            <span class="c1"># everything has happened - disable the apply button</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_applyButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># check for any errors</span>
        <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">errorValue</span><span class="p">:</span>
            <span class="c1"># re-populate popup from self.preferences on error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>

            <span class="c1"># revert the dialog paths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tempDialog</span><span class="o">.</span><span class="n">_restorePaths</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># remove all changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revertButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="PreferencesPopup.reject"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup.reject">[docs]</a>    <span class="k">def</span> <span class="nf">reject</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># revert the dialog paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempDialog</span><span class="o">.</span><span class="n">_restorePaths</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">reject</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_updateGui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updateSpectrumDisplays</span><span class="p">):</span>

        <span class="c1"># prompt the GLwidgets to update</span>
        <span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.OpenGL.CcpnOpenGL</span> <span class="kn">import</span> <span class="n">GLNotifier</span>

        <span class="n">GLSignals</span> <span class="o">=</span> <span class="n">GLNotifier</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">GLSignals</span><span class="o">.</span><span class="n">emitEvent</span><span class="p">(</span><span class="n">triggers</span><span class="o">=</span><span class="p">[</span><span class="n">GLNotifier</span><span class="o">.</span><span class="n">GLALLCONTOURS</span><span class="p">,</span>
                                      <span class="n">GLNotifier</span><span class="o">.</span><span class="n">GLALLPEAKS</span><span class="p">,</span>
                                      <span class="n">GLNotifier</span><span class="o">.</span><span class="n">GLALLMULTIPLETS</span><span class="p">,</span>
                                      <span class="n">GLNotifier</span><span class="o">.</span><span class="n">GLPREFERENCES</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">specDisplay</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">spectrumDisplays</span><span class="p">:</span>
            <span class="c1"># update the fixed/locked state</span>
            <span class="k">if</span> <span class="n">specDisplay</span><span class="o">.</span><span class="n">strips</span> <span class="ow">and</span> <span class="n">updateSpectrumDisplays</span><span class="p">:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">specDisplay</span><span class="o">.</span><span class="n">is1D</span><span class="p">:</span>
                    <span class="n">specDisplay</span><span class="o">.</span><span class="n">zPlaneNavigationMode</span> <span class="o">=</span> <span class="n">ZPlaneNavigationModes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zPlaneNavigationMode</span><span class="p">)</span><span class="o">.</span><span class="n">dataValue</span>
                    <span class="n">specDisplay</span><span class="o">.</span><span class="n">attachZPlaneWidgets</span><span class="p">()</span>
                <span class="n">specDisplay</span><span class="o">.</span><span class="n">_stripDirectionChangedInSettings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripArrangement</span><span class="p">)</span>
                <span class="c1"># specDisplay.setVisibleAxes()</span>

                <span class="c1"># update the ratios from preferences</span>
                <span class="n">specDisplay</span><span class="o">.</span><span class="n">strips</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">updateAxisRatios</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_setTabs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates the tabs as Frame Widget. All the children widgets will go in the Frame.</span>
<span class="sd">        Each frame will be the widgets parent.</span>
<span class="sd">        Tabs are displayed by the order how appear here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span> <span class="o">=</span> <span class="n">Tabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="o">*</span><span class="n">ZEROMARGINS</span><span class="p">)</span>
        <span class="c1"># self.tabWidget.getLayout().setSpacing(0)</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">tabFunc</span><span class="p">,</span> <span class="n">tabName</span><span class="p">)</span> <span class="ow">in</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_setGeneralTabWidgets</span><span class="p">,</span> <span class="s1">&#39;General&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSpectrumTabWidgets</span><span class="p">,</span> <span class="s1">&#39;Spectrum&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPeaksTabWidgets</span><span class="p">,</span> <span class="s1">&#39;Peaks&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setExternalProgramsTabWidgets</span><span class="p">,</span> <span class="s1">&#39;External Programs&#39;</span><span class="p">),</span>
                                   <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAppearanceTabWidgets</span><span class="p">,</span> <span class="s1">&#39;Appearance&#39;</span><span class="p">),</span>
                                   <span class="p">):</span>
            <span class="n">fr</span> <span class="o">=</span> <span class="n">ScrollableFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">DEFAULTSPACING</span><span class="p">,</span>
                                 <span class="n">scrollBarPolicies</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;never&#39;</span><span class="p">,</span> <span class="s1">&#39;asNeeded&#39;</span><span class="p">),</span> <span class="n">margins</span><span class="o">=</span><span class="n">TABMARGINS</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">fr</span><span class="o">.</span><span class="n">scrollArea</span><span class="p">,</span> <span class="n">tabName</span><span class="p">)</span>
            <span class="n">tabFunc</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">fr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setGeneralTabWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a widget in here to appear in the General Tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Language&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">languages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">PulldownListsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangeLanguage</span><span class="p">)</span>

        <span class="c1">#====== Layouts ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Layouts&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoSaveLayoutOnQuitBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auto-save on &#39;Quit&#39;&quot;</span><span class="p">,</span>
                                                     <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;autoSaveLayoutOnQuit&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restoreLayoutOnOpeningBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Restore on &#39;Open&#39;&quot;</span><span class="p">,</span>
                                                       <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;restoreLayoutOnOpening&#39;</span><span class="p">))</span>

        <span class="c1">#====== Auto Backups ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auto Backups&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupEnabledBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auto backup&quot;</span><span class="p">,</span>
                                                  <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;autoBackupEnabled&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Backup frequency (mins)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAutoBackupFrequency</span><span class="p">)</span>

        <span class="c1">#====== Paths ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Paths&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProjectPathBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Application uses project path&quot;</span><span class="p">,</span>
                                               <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;useProjectPath&#39;</span><span class="p">),</span>
                                               <span class="n">toolTip</span><span class="o">=</span><span class="s1">&#39;Set the application working path to the project folder on loading&#39;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;Application working path &quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getUserWorkingPath</span><span class="p">,</span>
                                            <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUserWorkingPath</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">userLayouts</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Layouts &quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsLeButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getUserLayoutsPath</span><span class="p">,</span>
                                          <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetuserLayoutsPath</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auxiliary files&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesDataButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getAuxiliaryFilesPath</span><span class="p">,</span>
                                               <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAuxiliaryFilesPath</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Macro&#39;s&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathDataButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getMacroFilesPath</span><span class="p">,</span>
                                          <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetMacroFilesPath</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plugins&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">tipText</span><span class="o">=</span><span class="n">NotImplementedTipText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathDataButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getPluginFilesPath</span><span class="p">,</span>
                                           <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetPluginFilesPath</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipesPathLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pipes&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipesPathDataButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getUserPipesPath</span><span class="p">,</span>
                                          <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetPipesFilesPath</span><span class="p">)</span>

        <span class="c1">#====== Proxy Settings ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Proxy Settings&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProxyBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use proxy settings&quot;</span><span class="p">,</span>
                                         <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUseProxy</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verifySSLBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Verify SSL certificates&quot;</span><span class="p">,</span>
                                          <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetVerifySSL</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Proxy server&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetProxyAddress</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Port&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetProxyPort</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProxyPasswordBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Server requires password&quot;</span><span class="p">,</span>
                                                 <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUseProxyPassword</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Username&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetProxyUsername</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Password&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span> <span class="o">=</span> <span class="n">PasswordEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetProxyPassword</span><span class="p">)</span>

        <span class="c1"># Add spacer to prevent rows from spreading into empty space</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">addSpacer</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expandX</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expandY</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_setAppearanceTabWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a widget in here to appear in the Appearance Tab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># GWV : moved to Spectrum tab</span>
        <span class="c1"># row += 1</span>
        <span class="c1"># self.colourSchemeLabel = _makeLabel(parent, text=&quot;Colour scheme &quot;, grid=(row, 0))</span>
        <span class="c1"># self.colourSchemeBox = PulldownList(parent, grid=(row, 1), hAlign=&#39;l&#39;)</span>
        <span class="c1"># self.colourSchemeBox.setToolTip(&#39;SpectrumDisplay background only&#39;)</span>
        <span class="c1"># self.colourSchemeBox.setMinimumWidth(PulldownListsMinimumWidth)</span>
        <span class="c1"># self.colourSchemeBox.addItems(COLOUR_SCHEMES)</span>
        <span class="c1"># self._oldColourScheme = None</span>
        <span class="c1"># self.colourSchemeBox.currentIndexChanged.connect(self._queueChangeColourScheme)</span>

        <span class="c1">#====== OS Behavior ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;OS Behavior&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeFileBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use native file dialogs&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                              <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;useNative&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeWebBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use native web browser&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                             <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;useNativeWebbrowser&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeWebBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeMenus</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use native menus (requires restart)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                            <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;useNativeMenus&#39;</span><span class="p">))</span>

        <span class="c1">#====== Module Behavior ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Module Behavior&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rememberLastClosedModule</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remember last settings&quot;</span><span class="p">,</span>
                                                      <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetRememberLastClosedModuleState</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runPyConsoleOnMacroEditor</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auto-open python console&quot;</span><span class="p">,</span>
                                                       <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAutoOpenPythonConsoleOnMacroEditor</span><span class="p">,</span>
                                                       <span class="n">toolTip</span><span class="o">=</span><span class="s2">&quot;Open python console when opening a macro editor module&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useOnlineDocumentation</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use online api-documentation&quot;</span><span class="p">,</span>
                                                    <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUseOnlineDocumentation</span><span class="p">,</span>
                                                    <span class="n">toolTip</span><span class="o">=</span><span class="s2">&quot;Use the online api-documentation instead of the local folder&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useOnlineDocumentation</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1">#====== Tip of the Day ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tip of the Day&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showTipsAtStartUp</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show at startup&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetShowTipsAtStartUp</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showAllTips</span> <span class="o">=</span> <span class="n">_makeButton</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tip history&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">buttonText</span><span class="o">=</span><span class="s1">&#39;Clear&#39;</span><span class="p">,</span>
                                       <span class="n">toolTip</span><span class="o">=</span><span class="s2">&quot;show all tips on next restart&quot;</span><span class="p">,</span>
                                       <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueShowAllTips</span><span class="p">)</span>

        <span class="c1"># GWV: option removed as test is done after Drop</span>
        <span class="c1"># row += 1</span>
        <span class="c1"># HLine(parent, grid=(row, 0), gridSpan=(1, 3), colour=_dividerColour, height=20)</span>
        <span class="c1">#</span>
        <span class="c1"># row += 1</span>
        <span class="c1"># self.useImportNefPopupLabel = Label(parent, text=&quot;Show Import Popup\n    on dropped Nef Files&quot;, grid=(row, 0))</span>
        <span class="c1"># self.useImportNefPopupBox = CheckBox(parent, grid=(row, 1))</span>
        <span class="c1"># self.useImportNefPopupBox.toggled.connect(partial(self._queueToggleAppearanceOptions, &#39;openImportPopupOnDroppedNef&#39;))</span>

        <span class="c1">#====== Fonts ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fonts (requires restart)&quot;</span><span class="p">)</span>

        <span class="c1"># NOTE:ED - testing new font loader</span>
        <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">fontName</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FONTLIST</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">_label</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fontName</span><span class="p">),</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_getFont</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">fontName</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
            <span class="n">_data</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">PulldownListsMinimumWidth</span><span class="p">)</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FONTLABELFORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">_label</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FONTDATAFORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">_data</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Spectrum display font size&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">PulldownListsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangeGLFontSize</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">addSpacer</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expandX</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expandY</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueShowAllTips</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setShowAllTips</span><span class="p">()</span>

        <span class="c1"># return a &#39;null&#39; function so that the revert/ok buttons appear correctly</span>
        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_setShowAllTips</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">seenTipsOfTheDay</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showAllTips</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetShowTipsAtStartUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showTipsAtStartUp</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showTipOfTheDay</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setShowTipsAtStartup</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setShowTipsAtStartup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showTipOfTheDay</span> <span class="o">=</span> <span class="n">state</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetRememberLastClosedModuleState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rememberLastClosedModule</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">rememberLastClosedModuleState</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setRememberLastClosedModuleState</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setRememberLastClosedModuleState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">rememberLastClosedModuleState</span> <span class="o">=</span> <span class="n">state</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAutoOpenPythonConsoleOnMacroEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rememberLastClosedModule</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">autoOpenPythonConsoleOnMacroEditor</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAutoOpenPythonConsoleOnMacroEditor</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAutoOpenPythonConsoleOnMacroEditor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">autoOpenPythonConsoleOnMacroEditor</span> <span class="o">=</span> <span class="n">state</span>

    <span class="c1"># def _queueClearSeenTips(self):</span>
    <span class="c1">#     #GST in this case the default should be no, but we can&#39;t do this yet... as yesNo doesn&#39;t support it</span>
    <span class="c1">#     #    also yes now should allow custom button names and have default and action button separated...</span>
    <span class="c1">#     result = showYesNo(parent=self, title=&quot;Reset Seen tips&quot;, message=&quot;Are you sure you want to clear the seen tips list&quot;)</span>
    <span class="c1">#     if result:</span>
    <span class="c1">#         self.preferences.general.seenTipsOfTheDay.clear()</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUseOnlineDocumentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useOnlineDocumentation</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">useOnlineDocumentation</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseOnlineDocumentation</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseOnlineDocumentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">useOnlineDocumentation</span> <span class="o">=</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">_populateAppearanceTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the appearanceTab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeFileBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">useNative</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeMenus</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">useNativeMenus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useNativeWebBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">useNativeWebbrowser</span><span class="p">)</span>
        <span class="c1"># self.useImportNefPopupBox.setChecked(self.preferences.appearance.openImportPopupOnDroppedNef)</span>

        <span class="k">for</span> <span class="n">fontNum</span><span class="p">,</span> <span class="n">fontName</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FONTLIST</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="p">[</span><span class="n">FONTPREFS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fontNum</span><span class="p">)]</span>
            <span class="n">_fontAttr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FONTDATAFORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fontNum</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFontText</span><span class="p">(</span><span class="n">_fontAttr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">_OLDGLFONT_SIZES</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">spectrumDisplayFontSize</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showTipsAtStartUp</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showTipOfTheDay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showAllTips</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">seenTipsOfTheDay</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rememberLastClosedModule</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">rememberLastClosedModuleState</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runPyConsoleOnMacroEditor</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">autoOpenPythonConsoleOnMacroEditor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useOnlineDocumentation</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">useOnlineDocumentation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the tabs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># clear all changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">blockChanges</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">useApplyToSpectrumDisplaysBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">applyToSpectrumDisplays</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populateGeneralTab</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populateSpectrumTab</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populatePeaksTab</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populateExternalProgramsTab</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populateAppearanceTab</span><span class="p">()</span>

<div class="viewcode-block" id="PreferencesPopup.setFontText"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup.setFontText">[docs]</a>    <span class="k">def</span> <span class="nf">setFontText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="n">fontString</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the contents of the widget the details of the font</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fontList</span> <span class="o">=</span> <span class="n">fontString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fontList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fontList</span>
                <span class="nb">type</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">fontList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">fontList</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">DEFAULTFONTNAME</span><span class="p">,</span> <span class="n">DEFAULTFONTSIZE</span><span class="p">,</span> <span class="n">DEFAULTFONTREGULAR</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">DEFAULTFONTNAME</span><span class="p">,</span> <span class="n">DEFAULTFONTSIZE</span><span class="p">,</span> <span class="n">DEFAULTFONTREGULAR</span>

        <span class="n">fontName</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">pt, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">if</span> <span class="nb">type</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">pt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">_fontString</span> <span class="o">=</span> <span class="n">fontString</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fontName</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_populateGeneralTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the generalTab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">languageBox</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">language</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoSaveLayoutOnQuitBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoSaveLayoutOnQuit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restoreLayoutOnOpeningBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">restoreLayoutOnOpening</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupEnabledBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoBackupEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoBackupFrequency</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProjectPathBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">useProjectPath</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userLayoutsPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">auxiliaryFilesPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userMacroPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userPluginPath</span><span class="p">)</span>

        <span class="n">userPipesPath</span> <span class="o">=</span> <span class="n">_fetchUserPipesPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="p">)</span>  <span class="c1"># gets from preferences or creates the default dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">userPipesPath</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verifySSLBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">verifySSL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProxyBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyAddress</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPort</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProxyPasswordBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxyPassword</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyUsername</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_userPreferences</span><span class="o">.</span><span class="n">decodeValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPassword</span><span class="p">)))</span>

        <span class="c1"># set the enabled state of some settings boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableProxyButtons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableAutoBackupFrequency</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableUserWorkingPath</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populateSpectrumTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the spectrumTab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoSetDataPathBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoSetDataPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">dataPath</span><span class="p">)</span>

        <span class="c1"># populate ValidateFrame</span>
        <span class="c1"># self._validateFrame._populate()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripRegionPadding</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showToolbarBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showToolbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumBorderBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showSpectrumBorder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showGridBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showGrid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCrosshairBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showCrosshair</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">showSideBands</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showLastAxisOnlyBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">lastAxisOnly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matchAxisCode</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">matchAxisCode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axisOrderingOptions</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">axisOrderingOptions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">scalingFactorStep</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomCentre</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomCentreType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomPercent</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripWidthZoomPercent</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspectRatioModeData</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatioMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripArrangement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zPlaneNavigationModeData</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zPlaneNavigationMode</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xAxisUnitsData</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">xAxisUnits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yAxisUnitsData</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">yAxisUnits</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomXLimitApplyBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomXLimitApply</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomYLimitApplyBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomYLimitApply</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">intensityLimit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotationsData</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">annotationType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolSizePixel</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolThickness</span><span class="p">))</span>

        <span class="c1"># _enabled = self.preferences.general.aliasEnabled</span>
        <span class="c1"># self.aliasEnabledData.setChecked(_enabled)</span>
        <span class="c1"># self.aliasShadeData.setValue(self.preferences.general.aliasShade)</span>
        <span class="c1"># self.aliasLabelsEnabledData.setChecked(self.preferences.general.aliasLabelsEnabled)</span>
        <span class="c1"># self.aliasLabelsEnabledData.setEnabled(_enabled)</span>
        <span class="c1"># self.aliasShadeData.setEnabled(_enabled)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">contourThickness</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">autoCorrectBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoCorrectColours</span><span class="p">)</span>
        <span class="n">_setColourPulldown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">defaultMarksColour</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">numSideBands</span><span class="p">))</span>

        <span class="c1"># multipletAveraging = self.preferences.general.multipletAveraging</span>
        <span class="c1"># self.multipletAveraging.setIndex(MULTIPLETAVERAGINGTYPES.index(multipletAveraging) if multipletAveraging in MULTIPLETAVERAGINGTYPES else 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleContoursBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">generateSinglePlaneContours</span><span class="p">)</span>
        <span class="c1"># self.negativeTraceColourBox.setChecked(self.preferences.general.traceIncludeNegative)</span>

        <span class="k">for</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">aspectValue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatios</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">aspect</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">aspect</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">aspectValue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populatePeaksTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the PeaksTab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">ccpn.core.lib.PeakPickers.PeakPickerABC</span> <span class="kn">import</span> <span class="n">PeakPickerABC</span><span class="p">,</span> <span class="n">getPeakPickerTypes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakDropFactor</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFactor1D</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">)</span>

        <span class="n">_peakPickers</span> <span class="o">=</span> <span class="n">getPeakPickerTypes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">pp</span> <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">_peakPickers</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">pp</span> <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">_peakPickers</span><span class="o">.</span><span class="n">keys</span><span class="p">()]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPicker1d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPickerNd</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peakFittingMethod</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="n">PEAKFITTINGDEFAULTS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFittingMethod</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">volumeIntegralLimit</span><span class="p">)</span>

        <span class="n">multipletAveraging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">multipletAveraging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletAveraging</span><span class="o">.</span><span class="n">setIndex</span><span class="p">(</span><span class="n">MULTIPLETAVERAGINGTYPES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">multipletAveraging</span><span class="p">)</span> <span class="k">if</span> <span class="n">multipletAveraging</span> <span class="ow">in</span> <span class="n">MULTIPLETAVERAGINGTYPES</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxDoFit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DBox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">negativePeakPick1D</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidths1d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidthsNd</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">_enabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasEnabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasEnabledData</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasShade</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledData</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasLabelsEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">peakLabelsEnabledData</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakLabelsEnabled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletLabelsEnabledData</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">multipletLabelsEnabled</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populateExternalProgramsTab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate the widgets in the externalProgramsTab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">blockChanges</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">external</span><span class="p">,</span> <span class="p">(</span><span class="n">extPath</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">[</span><span class="n">external</span><span class="p">]</span>
                <span class="n">extPath</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSpectrumTabWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a widget in here to appear in the Spectrum Tab. Parent = the Frame obj where the widget should live</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1">#====== Data Path ($DATA) ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Data Path ($DATA)&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoSetDataPathBox</span> <span class="o">=</span> <span class="n">_makeCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Auto set&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                                                <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;autoSetDataPath&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Data path&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">vAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUserDataPath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_getUserDataPath</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span>
                                         <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

        <span class="c1">#====== Spectrum Display ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Spectrum Display&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matchAxisCodeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Match axis codes by&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matchAxisCode</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Atom type&#39;</span><span class="p">,</span> <span class="s1">&#39;Full axis code&#39;</span><span class="p">],</span>
                                          <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetMatchAxisCode</span><span class="p">,</span>
                                          <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                          <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                          <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                          <span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axisOrderingOptionsLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Displayed axes order&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axisOrderingOptions</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span>
                                                <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Use spectrum settings&#39;</span><span class="p">,</span> <span class="s1">&#39;Always ask&#39;</span><span class="p">],</span>
                                                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAxisOrderingOptions</span><span class="p">,</span>
                                                <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                                <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                <span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_height</span> <span class="o">=</span> <span class="n">getFontHeight</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="s1">&#39;VLARGE&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">24</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Strip arrangement&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;    &#39;</span><span class="p">,</span> <span class="s1">&#39;    &#39;</span><span class="p">,</span> <span class="s1">&#39;    &#39;</span><span class="p">],</span>
                                                    <span class="c1"># selectedInd=stripArrangement,</span>
                                                    <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
                                                    <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span>
                                                    <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                    <span class="n">icons</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;icons/strip-row&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">_height</span><span class="p">,</span> <span class="n">_height</span><span class="p">)),</span>
                                                           <span class="p">(</span><span class="s1">&#39;icons/strip-column&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">_height</span><span class="p">,</span> <span class="n">_height</span><span class="p">)),</span>
                                                           <span class="p">(</span><span class="s1">&#39;icons/strip-tile&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">_height</span><span class="p">,</span> <span class="n">_height</span><span class="p">))</span>
                                                           <span class="p">],</span>
                                                    <span class="p">)</span>
        <span class="c1"># NOTE:ED - temporarily disable/hide the Tile button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span><span class="o">.</span><span class="n">radioButtons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span><span class="o">.</span><span class="n">radioButtons</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span><span class="o">.</span><span class="n">setCallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetStripArrangement</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showLastAxisOnlyLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Strips share X- or Y-axis&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showLastAxisOnlyBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showLastAxisOnlyBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;lastAxisOnly&#39;</span><span class="p">))</span>

        <span class="c1"># # add validate frame</span>
        <span class="c1"># row += 1</span>
        <span class="c1"># self._validateFrame = ValidateSpectraForPreferences(parent, mainWindow=self.mainWindow, spectra=self.project.spectra,</span>
        <span class="c1">#                                                     setLayout=True, showBorder=False, grid=(row, 0), gridSpan=(1, 3))</span>
        <span class="c1">#</span>
        <span class="c1"># self._validateFrame._filePathCallback = self._queueSetValidateFilePath</span>
        <span class="c1"># self._validateFrame._dataUrlCallback = self._queueSetValidateDataUrl</span>
        <span class="c1"># self._validateFrame._matchDataUrlWidths = parent</span>
        <span class="c1"># self._validateFrame._matchFilePathWidths = parent</span>
        <span class="c1">#</span>
        <span class="c1"># self._validateFrame.setVisible(False)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xAxisUnits</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Default X-axis units&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xAxisUnitsData</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">AXISUNITS</span><span class="p">,</span>
                                           <span class="c1"># selectedInd=xAxisUnits,</span>
                                           <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetXUnits</span><span class="p">,</span>
                                           <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                           <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span>
                                           <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                           <span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yAxisUnits</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Default Y-axis units&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yAxisUnitsData</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">AXISUNITS</span><span class="p">,</span>
                                           <span class="c1"># selectedInd=yAxisUnits,</span>
                                           <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetYUnits</span><span class="p">,</span>
                                           <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                           <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span>
                                           <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zPlaneNavigationModeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plane navigation mode&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zPlaneNavigationModeData</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ZPlaneNavigationModes</span><span class="p">],</span>
                                                     <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetZPlaneNavigationMode</span><span class="p">,</span>
                                                     <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                                     <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                     <span class="n">tipTexts</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Plane navigation tools are located at the bottom of the spectrumDisplay,</span><span class="se">\n</span><span class="s1">and will operate on the selected strip in that spectrumDisplay&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;Plane navigation tools are located at the bottom of each strip&#39;</span><span class="p">,</span>
                                                               <span class="s1">&#39;Plane navigation tools are displayed in the upper-left corner of each strip&#39;</span><span class="p">),</span>
                                                     <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zPlaneNavigationModeLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Select where the Plane navigation tools are located&#39;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useApplyToSpectrumDisplaysLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Apply to open SpectrumDisplay&#39;s&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useApplyToSpectrumDisplaysBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useApplyToSpectrumDisplaysBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueApplyToSpectrumDisplays</span><span class="p">,</span> <span class="s1">&#39;applyToSpectrumDisplays&#39;</span><span class="p">))</span>

        <span class="c1">#====== Aspect ratios ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Aspect Ratios&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspectRatioModeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Mode&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspectRatioModeData</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Free&#39;</span><span class="p">,</span> <span class="s1">&#39;Locked&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed&#39;</span><span class="p">],</span>
                                                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAspectRatioMode</span><span class="p">,</span>
                                                <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                                <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                <span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Fixed aspect ratios:&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># row += 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspectLabel</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatios</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aspectLabel</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Label</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ScientificDoubleSpinBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAspect</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ii</span><span class="p">))</span>

        <span class="c1"># ====== Scaling ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Scaling&quot;</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Single step scaling factor&quot;</span><span class="p">,</span>
                                               <span class="n">tipText</span><span class="o">=</span> <span class="s1">&#39;Set the single step for rescaling a current spectrum using the shortcuts.&#39;</span><span class="p">,</span>
                                               <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingData</span> <span class="o">=</span> <span class="n">ScientificDoubleSpinBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSpectrumScaling</span><span class="p">)</span>

        <span class="c1">#====== Zooming ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zooming&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomCentreLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Zoom centre&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomCentre</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;Screen&#39;</span><span class="p">],</span>
                                       <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetZoomCentre</span><span class="p">,</span>
                                       <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                       <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                       <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                       <span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Manual zoom (%)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetZoomPercent</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Strip width zoom (%)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                       <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetStripWidthZoomPercent</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomXLimitApplyLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;X-axis zoom limit&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomXLimitApplyBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomXLimitApplyBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;zoomXLimitApply&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomYLimitApplyLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Y-axis zoom limit&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomYLimitApplyBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showZoomYLimitApplyBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;zoomYLimitApply&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Intensity-axis zoom limit&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span> <span class="o">=</span> <span class="n">ScientificDoubleSpinBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetIntensityLimit</span><span class="p">)</span>

        <span class="c1">#====== Show ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Spectral padding (%)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetRegionPadding</span><span class="p">)</span>

        <span class="c1">### Not fully Tested, Had some issues with $Path routines in setting the path of the copied spectra.</span>
        <span class="c1">###  Needs more testing for different spectra formats etc. Disabled until completion.</span>
        <span class="c1"># row += 1</span>
        <span class="c1"># self.keepSPWithinProjectTipText = &#39;Keep a copy of spectra inside the project directory. Useful when changing the original spectra location path&#39;</span>
        <span class="c1"># self.keepSPWithinProject = Label(parent, text=&quot;Keep a Copy Inside Project&quot;, grid=(row, 0))</span>
        <span class="c1"># self.keepSPWithinProjectBox = CheckBox(parent, grid=(row, 1), checked=self.preferences.general.keepSpectraInsideProject,</span>
        <span class="c1">#                                        tipText=self.keepSPWithinProjectTipText)</span>
        <span class="c1"># self.keepSPWithinProjectBox.toggled.connect(partial(self._queueToggleGeneralOptions, &#39;keepSpectraInsideProject&#39;))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showToolbarLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;ToolBar(s)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showToolbarBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showToolbarBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;showToolbar&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumBorderLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Spectrum borders&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumBorderBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spectrumBorderBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;showSpectrumBorder&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showGridLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Grids&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showGridBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showGridBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;showGrid&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCrosshairLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Crosshairs&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCrosshairBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showCrosshairBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;showCrosshair&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;MAS side-bands&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;showSideBands&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBands</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Number of MAS side-bands&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetNumSideBands</span><span class="p">)</span>

        <span class="c1">#====== Contours and Colours ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Contour and Colours&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleContoursLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Single contours per plane&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleContoursBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">singleContoursBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;generateSinglePlaneContours&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Contour thickness (pixel)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessData</span> <span class="o">=</span> <span class="n">Spinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetContourThickness</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Spectrum display background&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set SpectrumDisplay background&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">PulldownListsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">COLOUR_SCHEMES</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldColourScheme</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colourSchemeBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangeColourScheme</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoCorrectLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Autocorrect colours&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoCorrectBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoCorrectBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;autoCorrectColours&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Default marks colour&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">_colourFrame</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">_colourFrame</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>

        <span class="c1"># populate colour pulldown and set to the current colour</span>
        <span class="n">fillColourPulldown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="p">,</span> <span class="n">allowAuto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">includeGradients</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangeMarksColourIndex</span><span class="p">)</span>

        <span class="c1"># add a colour dialog button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">_colourFrame</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span>
                                               <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/colours&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangeMarksColourButton</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negativeTraceColourLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Negative colour for phasing traces&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negativeTraceColourBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">negativeTraceColourBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;traceIncludeNegative&#39;</span><span class="p">))</span>

        <span class="c1">#==== add spacer to stop columns changing width</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">addSpacer</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expandX</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expandY</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_setPeaksTabWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a widget in here to appear in the Peaks and Multiplets Tab. Parent = the Frame obj where the widget should live</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1">#====== Peak Picking ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Peak Picking&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFittingMethodLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Peak interpolation method&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFittingMethod</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">PEAKFITTINGDEFAULTS</span><span class="p">,</span>
                                              <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetPeakFittingMethod</span><span class="p">,</span>
                                              <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                              <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                              <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                              <span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Default 1D peak picker&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangePeakPicker1dIndex</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;1D Peak picking drop (%)&quot;</span><span class="p">,</span> <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Increase to filter out more&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetDropFactor1D</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Default nD peak picker&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span> <span class="o">=</span> <span class="n">PulldownList</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueChangePeakPickerNdIndex</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;nD Peak picking drop (%)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetDropFactor</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Volume integral limit&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span> <span class="o">=</span> <span class="n">DoubleSpinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                     <span class="nb">min</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetVolumeIntegralLimit</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLabelsEnabledLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show peak labels&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLabelsEnabledData</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peakLabelsEnabledData</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;peakLabelsEnabled&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletLabelsEnabledLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show multiplet labels&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletLabelsEnabledData</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletLabelsEnabledData</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;multipletLabelsEnabled&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasEnabledLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show aliased peaks&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasEnabledData</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasEnabledData</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;aliasEnabled&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show aliased labels&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledData</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledData</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueToggleGeneralOptions</span><span class="p">,</span> <span class="s1">&#39;aliasLabelsEnabled&#39;</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Label opacity&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">_sliderBox</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="c1"># self.aliasShadeData = Slider(parent, grid=(row, 1), hAlign=&#39;l&#39;)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">_sliderBox</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;0%&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span> <span class="o">=</span> <span class="n">Slider</span><span class="p">(</span><span class="n">_sliderBox</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="n">Label</span><span class="p">(</span><span class="n">_sliderBox</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAliasShade</span><span class="p">)</span>

        <span class="c1">#====== Peak Fitting ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Peak Fitting&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Fit after snap-to-extrema&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUseSearchBoxDoFit</span><span class="p">)</span>
        <span class="n">_toolTip</span> <span class="o">=</span> <span class="s1">&#39;Option to apply fitting method after initial snap to extrema&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_toolTip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitBox</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_toolTip</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include negative peaks 1D&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetdoNegPeak1D</span><span class="p">)</span>
        <span class="n">_toolTip</span> <span class="o">=</span> <span class="s1">&#39;Pick and snap to negative regions of the spectra&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_toolTip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DBox</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">_toolTip</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Use search box&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeBox</span> <span class="o">=</span> <span class="n">CheckBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeBox</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetUseSearchBoxMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeLabel</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
                <span class="s1">&#39;Use defined search box widths (ppm)</span><span class="se">\n</span><span class="s1">or default to ±4 index points.</span><span class="se">\n</span><span class="s1">Note, default will depend on resolution of spectrum&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeBox</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
                <span class="s1">&#39;Use defined search box widths (ppm)</span><span class="se">\n</span><span class="s1">or default to ±4 index points.</span><span class="se">\n</span><span class="s1">Note, default will depend on resolution of spectrum&#39;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;1D box widths (ppm):&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dLabel</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidths1d</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dLabel</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ScientificDoubleSpinBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSearchBox1d</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ii</span><span class="p">))</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;nD box widths (ppm):&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="c1"># self.searchBoxNdLabel = {}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidthsNd</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ScientificDoubleSpinBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSearchBoxNd</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">ii</span><span class="p">))</span>

        <span class="c1">#======  Peak Symbols ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Peak Symbols&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotationsLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">annotationsData</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Short&#39;</span><span class="p">,</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="s1">&#39;NmrAtom Pid&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimal&#39;</span><span class="p">,</span> <span class="s1">&#39;Peak Pid&#39;</span><span class="p">,</span> <span class="s1">&#39;ClusterId&#39;</span><span class="p">,</span> <span class="s1">&#39;Annotation&#39;</span><span class="p">],</span>
                                            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetAnnotations</span><span class="p">,</span>
                                            <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                            <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                            <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                            <span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolsLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Symbol&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cross&#39;</span><span class="p">,</span> <span class="s1">&#39;lineWidths&#39;</span><span class="p">,</span> <span class="s1">&#39;Filled lineWidths&#39;</span><span class="p">,</span> <span class="s1">&#39;Plus&#39;</span><span class="p">],</span>
                                   <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSymbol</span><span class="p">,</span>
                                   <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                   <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                   <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                   <span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Size (pixel)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelData</span> <span class="o">=</span> <span class="n">Spinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                           <span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSymbolSizePixel</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Thickness (pixel)&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessData</span> <span class="o">=</span> <span class="n">Spinbox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                           <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessData</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessData</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetSymbolThickness</span><span class="p">)</span>

        <span class="c1">#====== Multiplets ======</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">_makeLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Multiplets&quot;</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletAveragingLabel</span> <span class="o">=</span> <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Multiplet Averaging&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multipletAveraging</span> <span class="o">=</span> <span class="n">RadioButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">MULTIPLETAVERAGINGTYPES</span><span class="p">,</span>
                                               <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetMultipletAveraging</span><span class="p">,</span>
                                               <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                                               <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                               <span class="n">tipTexts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                               <span class="p">)</span>

        <span class="c1">#==== add spacer to stop columns changing width</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">addSpacer</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expandX</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expandY</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangeMarksColourIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">colName</span> <span class="o">=</span> <span class="n">colourNameNoSpace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="o">.</span><span class="n">getText</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">colName</span> <span class="ow">in</span> <span class="n">spectrumColours</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">colName</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spectrumColours</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="nb">list</span><span class="p">(</span><span class="n">spectrumColours</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">colName</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">colName</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">defaultMarksColour</span><span class="p">:</span>
                <span class="c1"># and list(spectrumColours.keys())[value] != self.preferences.general.defaultMarksColour:</span>
                <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changeMarksColourIndex</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_changeMarksColourIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the default maerks colour in the preferences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colName</span> <span class="o">=</span> <span class="n">colourNameNoSpace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">colName</span> <span class="ow">in</span> <span class="n">spectrumColours</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">newColour</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spectrumColours</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="nb">list</span><span class="p">(</span><span class="n">spectrumColours</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">colName</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newColour</span> <span class="o">=</span> <span class="n">colName</span>

        <span class="k">if</span> <span class="n">newColour</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">defaultMarksColour</span> <span class="o">=</span> <span class="n">newColour</span>

    <span class="k">def</span> <span class="nf">_queueChangeMarksColourButton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;set the default marks colour from the colour dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">ColourDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">newColour</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">getColor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">newColour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">addNewColour</span><span class="p">(</span><span class="n">newColour</span><span class="p">)</span>
            <span class="n">fillColourPulldown</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="p">,</span> <span class="n">allowAuto</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">includeGradients</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">marksDefaultColourBox</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">spectrumColours</span><span class="p">[</span><span class="n">newColour</span><span class="o">.</span><span class="n">name</span><span class="p">()])</span>

    <span class="k">def</span> <span class="nf">_setExternalProgramsTabWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Insert a widget in here to appear in the externalPrograms Tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># self.preferences.externalPrograms is a (programName, programPath) dict</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">programName</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="n">_makeLabel</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">programName</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="n">externalPath</span> <span class="o">=</span> <span class="n">PathEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hAlign</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">fileMode</span><span class="o">=</span><span class="n">VALIDFILE</span><span class="p">)</span>
            <span class="n">externalPath</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">LineEditsMinimumWidth</span><span class="p">)</span>
            <span class="n">externalPath</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queueSetExternalPath</span><span class="p">,</span> <span class="n">programName</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

            <span class="n">externalButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_getExternalPath</span><span class="p">,</span> <span class="n">programName</span><span class="p">),</span>
                                    <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/directory&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>

            <span class="n">externalTestButton</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_testExternalPath</span><span class="p">,</span> <span class="n">programName</span><span class="p">),</span>
                                        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">[</span><span class="n">programName</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">externalPath</span><span class="p">,</span> <span class="n">externalButton</span><span class="p">,</span> <span class="n">externalTestButton</span><span class="p">)</span>

            <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># add spacer to stop columns changing width</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">addSpacer</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">expandX</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expandY</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">gridSpan</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_testExternalPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">external</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined in preferences&#39;</span><span class="p">)</span>

        <span class="n">widgetList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">[</span><span class="n">external</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extPath</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">widgetList</span>

            <span class="n">program</span> <span class="o">=</span> <span class="n">extPath</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_testExternalProgram</span><span class="p">(</span><span class="n">program</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Failed&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Success&#39;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">es</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> does not contain the correct widgets&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_testExternalProgram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># TODO:ED check whether relative or absolute path and test</span>
            <span class="c1"># import ccpn.framework.PathsAndUrls as PAU</span>
            <span class="c1"># pathCwd = PAU.ccpnCodePath</span>
            <span class="c1"># programPath = os.path.abspath(os.path.join(pathCwd, program))</span>

            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">program</span><span class="p">,</span>
                                 <span class="n">shell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                                 <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Testing External program: Failed.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUserDataPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">dataPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUserDataPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUserDataPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">dataPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">SpectrumFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getUserDataPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">SpectrumFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_enableUserDataPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;callback upon changing autoSetDataPathBox&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoSetDataPathBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userDataPathText</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="ow">not</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUserWorkingPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUserWorkingPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUserWorkingPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userWorkingPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">ProjectFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getUserWorkingPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">ProjectFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_enableUserWorkingPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useProjectPathBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">userWorkingPathData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="ow">not</span> <span class="n">value</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAuxiliaryFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">auxiliaryFilesPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAuxiliaryFilesPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAuxiliaryFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">auxiliaryFilesPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">AuxiliaryFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getAuxiliaryFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">AuxiliaryFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auxiliaryFilesData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># @queueStateChange(_verifyPopupApply)</span>
    <span class="c1"># def _queueSetValidateDataUrl(self, dataUrl, newUrl, urlValid, dim):</span>
    <span class="c1">#     &quot;&quot;&quot;Set the new url in the dataUrl</span>
    <span class="c1">#     dim is required by the decorator to give a unique id for dataUrl row</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if newUrl != dataUrl.url.path:</span>
    <span class="c1">#         return partial(self._validatePreferencesDataUrl, dataUrl, newUrl, urlValid, dim)</span>
    <span class="c1">#</span>
    <span class="c1"># def _validatePreferencesDataUrl(self, dataUrl, newUrl, urlValid, dim):</span>
    <span class="c1">#     &quot;&quot;&quot;Put the new dataUrl into the dataUrl and the preferences.general.dataPath</span>
    <span class="c1">#     Extra step incase urlValid needs to be checked</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if dim == 0:</span>
    <span class="c1">#         # must be the first dataUrl for the preferences</span>
    <span class="c1">#         # self.preferences.general.dataPath = newUrl</span>
    <span class="c1">#         pass</span>
    <span class="c1">#</span>
    <span class="c1">#     # if urlValid:</span>
    <span class="c1">#     # self._validateFrame.dataUrlFunc(dataUrl, newUrl)</span>

    <span class="c1"># @queueStateChange(_verifyPopupApply)</span>
    <span class="c1"># def _queueSetValidateFilePath(self, spectrum, filePath, dim):</span>
    <span class="c1">#     &quot;&quot;&quot;Set the new filePath for the spectrum</span>
    <span class="c1">#     dim is required by the decorator to give a unique id for filePath row</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     if filePath != spectrum.filePath:</span>
    <span class="c1">#         return partial(self._validateFrame.filePathFunc, spectrum, filePath)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetuserLayoutsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userLayoutsPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUserLayoutsPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUserLayoutsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userLayoutsPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">LayoutsFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getUserLayoutsPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">LayoutsFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">userLayoutsPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetMacroFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userMacroPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setMacroFilesPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setMacroFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userMacroPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">MacrosFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getMacroFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">MacrosFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">macroPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetPluginFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userPluginPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPluginFilesPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPluginFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userPluginPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">PluginsFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getPluginFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">PluginsFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pluginPathData</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetPipesFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userPipesPath</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPipesFilesPath</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPipesFilesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">userPipesPath</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">PipelineFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">initialPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">_getUserPipesPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">aPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">currentDataPath</span> <span class="o">=</span> <span class="n">currentDataPath</span> <span class="k">if</span> <span class="n">currentDataPath</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="k">else</span> <span class="n">aPath</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">PipelineFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="n">currentDataPath</span><span class="p">,</span> <span class="n">_useDirectoryOnly</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFiles</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">userPipesPath</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setPipesFilesPath</span><span class="p">(</span><span class="n">directory</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangeLanguage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">languages</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">language</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changeLanguage</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_changeLanguage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">language</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangeColourScheme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">COLOUR_SCHEMES</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changeColourScheme</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_changeColourScheme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">colourScheme</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueToggleGeneralOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggle a general checkbox option in the preferences</span>
<span class="sd">        Requires the parameter to be called &#39;option&#39; so that the decorator gives it a unique name</span>
<span class="sd">        in the internal updates dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;useProjectPath&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enableUserWorkingPath</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;autoSetDataPath&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enableUserDataPath</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;autoBackupEnabled&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enableAutoBackupFrequency</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;aliasEnabled&#39;</span><span class="p">:</span>
            <span class="n">_enabled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliasEnabledData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aliasLabelsEnabledData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">_enabled</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">checked</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="p">[</span><span class="n">option</span><span class="p">]:</span>
            <span class="c1"># change the enabled state of checkboxes as required</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toggleGeneralOptions</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_toggleGeneralOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">checked</span>

        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">&#39;autoBackupEnabled&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_updateAutoBackup</span><span class="p">()</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueToggleAppearanceOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggle a general checkbox option in the preferences</span>
<span class="sd">        Requires the parameter to be called &#39;option&#39; so that the decorator gives it a unique name</span>
<span class="sd">        in the internal updates dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="p">[</span><span class="n">option</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toggleAppearanceOptions</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_toggleAppearanceOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="p">[</span><span class="n">option</span><span class="p">]</span> <span class="o">=</span> <span class="n">checked</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetExternalPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">external</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queue the change to the correct item in preferences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined in preferences&#39;</span><span class="p">)</span>

        <span class="n">widgetList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">[</span><span class="n">external</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extPath</span><span class="p">,</span> <span class="n">extButton</span><span class="p">,</span> <span class="n">extTestButton</span> <span class="o">=</span> <span class="n">widgetList</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">extPath</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">oldValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">[</span><span class="n">external</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">oldValue</span><span class="p">:</span>
                <span class="n">extTestButton</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setExternalPath</span><span class="p">,</span> <span class="n">external</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">es</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> does not contain the correct widgets </span><span class="si">{</span><span class="n">es</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setExternalPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">external</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the path in preferences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;externalPrograms&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span> <span class="ow">and</span> <span class="n">external</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">[</span><span class="n">external</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_getExternalPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">external</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the correct path from preferences</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE:ED - native dialog on OSX does not show contents of an .app dir.</span>

        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">externalPrograms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">external</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> not defined in preferences&#39;</span><span class="p">)</span>

        <span class="n">widgetList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalPaths</span><span class="p">[</span><span class="n">external</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extPath</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">widgetList</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">extPath</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">dialog</span> <span class="o">=</span> <span class="n">ExecutablesFileDialog</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">acceptMode</span><span class="o">=</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">_show</span><span class="p">()</span>
            <span class="n">file</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">selectedFile</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">extPath</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">es</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">external</span><span class="si">}</span><span class="s1"> does not contain the correct widgets&#39;</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAutoBackupFrequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoBackupFrequency</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAutoBackupFrequency</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAutoBackupFrequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">autoBackupFrequency</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_updateAutoBackup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_enableAutoBackupFrequency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupEnabledBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">autoBackupFrequencyData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetRegionPadding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regionPaddingData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripRegionPadding</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setRegionPadding</span><span class="p">,</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setRegionPadding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripRegionPadding</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetDropFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropFactorData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakDropFactor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setDropFactor</span><span class="p">,</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setDropFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakDropFactor</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetDropFactor1D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFactor1D</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set1DPeakFactor</span><span class="p">,</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set1DPeakFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFactor1D</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSymbolSizePixel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolSizePixelData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolSizePixel</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSymbolSizePixel</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSymbolSizePixel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the size of the symbols (pixels)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolSizePixel</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSymbolThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolThicknessData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolThickness</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSymbolThickness</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSymbolThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Thickness of the peak symbols (ppm)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolThickness</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetContourThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contourThicknessData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">contourThickness</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setContourThickness</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setContourThickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Thickness of the peak contours (ppm)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">contourThickness</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAliasShade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aliasShadeData</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasShade</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAliasShade</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAliasShade</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the aliased peaks Shade 0.0-&gt;1.0; 0.0 is invisible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aliasShade</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetXUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xAxisUnitsData</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">xAxisUnits</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setXAxisUnits</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="PreferencesPopup.setXAxisUnits"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup.setXAxisUnits">[docs]</a>    <span class="k">def</span> <span class="nf">setXAxisUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the xAxisUnits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">xAxisUnits</span> <span class="o">=</span> <span class="n">value</span></div>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetYUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yAxisUnitsData</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">yAxisUnits</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setYAxisUnits</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="PreferencesPopup.setYAxisUnits"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.PreferencesPopup.PreferencesPopup.setYAxisUnits">[docs]</a>    <span class="k">def</span> <span class="nf">setYAxisUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the yAxisUnits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">yAxisUnits</span> <span class="o">=</span> <span class="n">value</span></div>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetZPlaneNavigationMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zPlaneNavigationModeData</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zPlaneNavigationMode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setZPlaneNavigationMode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setZPlaneNavigationMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the zPlaneNavigationMode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zPlaneNavigationMode</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAspectRatioMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aspectRatioModeData</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatioMode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAspectRatioMode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAspectRatioMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the aspectRatioMode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatioMode</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotationsData</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">annotationType</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAnnotations</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAnnotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the annotation type for the pid labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">annotationType</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolType</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSymbol</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the peak symbol type - current a cross or lineWidths</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">symbolType</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetStripArrangement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stripArrangementButtons</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripArrangement</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setStripArrangement</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setStripArrangement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the stripArrangement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripArrangement</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetZoomCentre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoomCentre</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomCentreType</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setZoomCentre</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setZoomCentre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the zoom centring method to either mouse position or centre of the screen</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomCentreType</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetZoomPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zoomPercentData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomPercent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setZoomPercent</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSpectrumScaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectrumScalingData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSpectrumScaling</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSpectrumScaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for manual zoom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">scalingFactorStep</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_setZoomPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for manual zoom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">zoomPercent</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetStripWidthZoomPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stripWidthZoomPercentData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripWidthZoomPercent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setStripWidthZoomPercent</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setStripWidthZoomPercent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for increasing/decreasing width of strips</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">stripWidthZoomPercent</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetNumSideBands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showSideBandsData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">numSideBands</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setNumSideBands</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setNumSideBands</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for number of sideband gridlines to display</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">numSideBands</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetMatchAxisCode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matchAxisCode</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">matchAxisCode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setMatchAxisCode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setMatchAxisCode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the matching of the axis codes across different strips</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">matchAxisCode</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAxisOrderingOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axisOrderingOptions</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">axisOrderingOptions</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAxisOrderingOptions</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAxisOrderingOptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the option for the axis ordering of strips when opening a new display</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">axisOrderingOptions</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangePeakPicker1dIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakPicker1dData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPicker1d</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPeakPicker1d</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPeakPicker1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the default peak picker for 1d spectra</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPicker1d</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangePeakPickerNdIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peakPickerNdData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPickerNd</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPeakPickerNd</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPeakPickerNd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the default peak picker for Nd spectra</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakPickerNd</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetPeakFittingMethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">PEAKFITTINGDEFAULTS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">peakFittingMethod</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFittingMethod</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setPeakFittingMethod</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setPeakFittingMethod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the matching of the axis codes across different strips</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">peakFittingMethod</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetAspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;dim is required by the decorator to give a unique id for aspect dim</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">aspect</span><span class="p">]</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aspectData</span><span class="p">[</span><span class="n">aspect</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatios</span><span class="p">[</span><span class="n">aspect</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setAspect</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setAspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aspect</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the aspect ratio for the axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">aspectRatios</span><span class="p">[</span><span class="n">aspect</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUseSearchBoxMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxModeBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxMode</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseSearchBoxMode</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseSearchBoxMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxMode</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUseSearchBoxDoFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useSearchBoxDoFitBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxDoFit</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseSearchBoxDoFit</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseSearchBoxDoFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxDoFit</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetdoNegPeak1D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doNegPeak1DBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">negativePeakPick1D</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseSearchBoxDoFit</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setdoNegPeak1D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">negativePeakPick1D</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSearchBox1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchBox1d</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;dim is required by the decorator to give a unique id for searchBox dim</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">searchBox1d</span><span class="p">]</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBox1dData</span><span class="p">[</span><span class="n">searchBox1d</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidths1d</span><span class="p">[</span><span class="n">searchBox1d</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSearchBox1d</span><span class="p">,</span> <span class="n">searchBox1d</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSearchBox1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchBox1d</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the searchBox1d width for the axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidths1d</span><span class="p">[</span><span class="n">searchBox1d</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetSearchBoxNd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchBoxNd</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;dim is required by the decorator to give a unique id for searchBox dim</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">searchBoxNd</span><span class="p">]</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">searchBoxNdData</span><span class="p">[</span><span class="n">searchBoxNd</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidthsNd</span><span class="p">[</span><span class="n">searchBoxNd</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setSearchBoxNd</span><span class="p">,</span> <span class="n">searchBoxNd</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setSearchBoxNd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">searchBoxNd</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the searchBoxNd width for the axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">searchBoxWidthsNd</span><span class="p">[</span><span class="n">searchBoxNd</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetIntensityLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">showIntensityLimitBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">intensityLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setIntensityLimit</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setIntensityLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for the minimum intensity limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">intensityLimit</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetMultipletAveraging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multipletAveraging</span><span class="o">.</span><span class="n">getIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">multipletAveraging</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setMultipletAveraging</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setMultipletAveraging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the multiplet averaging type - normal or weighted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">multipletAveraging</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetVolumeIntegralLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">textFromValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span><span class="o">.</span><span class="n">textFromValue</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volumeIntegralLimitData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">prefValue</span> <span class="o">=</span> <span class="n">textFromValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">volumeIntegralLimit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">textFromValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">prefValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setVolumeIntegralLimit</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setVolumeIntegralLimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value for increasing/decreasing width of strips</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">volumeIntegralLimit</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetVerifySSL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verifySSLBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">verifySSL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setVerifySSL</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setVerifySSL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">verifySSL</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUseProxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useProxyBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># set the state of the other buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableProxyButtons</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseProxy</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseProxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxy</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueUseSystemProxy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useSystemProxyBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># set the state of the other buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableProxyButtons</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useSystemProxy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseSystemProxy</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseSystemProxy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useSystemProxy</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetProxyAddress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyAddress</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setProxyAddress</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setProxyAddress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyAddress</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetProxyPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPort</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setProxyPort</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setProxyPort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPort</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetUseProxyPassword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useProxyPasswordBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># set the state of the other buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enableProxyButtons</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxyPassword</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setUseProxyPassword</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setUseProxyPassword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">useProxyPassword</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetProxyUsername</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyUsername</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setProxyUsername</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setProxyUsername</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyUsername</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetProxyPassword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userPreferences</span><span class="o">.</span><span class="n">encodeValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPassword</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setProxyPassword</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setProxyPassword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">proxySettings</span><span class="o">.</span><span class="n">proxyPassword</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_enableProxyButtons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable/disable proxy widgets based on check boxes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">usePW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useProxyPasswordBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">useProxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">useProxyBox</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">proxyAddressData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">useProxy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPortData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">useProxy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useProxyPasswordBox</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">useProxy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyUsernameData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">useProxy</span> <span class="ow">and</span> <span class="n">usePW</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxyPasswordData</span><span class="o">.</span><span class="n">enableWidget</span><span class="p">(</span><span class="n">useProxy</span> <span class="ow">and</span> <span class="n">usePW</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueApplyToSpectrumDisplays</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggle a general checkbox option in the preferences</span>
<span class="sd">        Requires the parameter to be called &#39;option&#39; so that the decorator gives it a unique name</span>
<span class="sd">        in the internal updates dict</span>
<span class="sd">        - not sure whether needed now</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">general</span><span class="p">[</span><span class="n">option</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toggleGeneralOptions</span><span class="p">,</span> <span class="n">option</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueSetFont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
        <span class="n">_fontAttr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FONTDATAFORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">_fontAttr</span><span class="o">.</span><span class="n">_fontString</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="p">[</span><span class="n">FONTPREFS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">)]:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setFont</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setFont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="p">[</span><span class="n">FONTPREFS</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_getFont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">fontName</span><span class="p">):</span>
        <span class="c1"># Simple font grabber from the system</span>
        <span class="n">_fontAttr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FONTDATAFORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">_fontAttr</span><span class="o">.</span><span class="n">_fontString</span>
        <span class="n">_font</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">()</span>
        <span class="n">_font</span><span class="o">.</span><span class="n">fromString</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">newFont</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFontDialog</span><span class="o">.</span><span class="n">getFont</span><span class="p">(</span><span class="n">_font</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;Select </span><span class="si">{}</span><span class="s1"> Font&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fontName</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFontText</span><span class="p">(</span><span class="n">_fontAttr</span><span class="p">,</span> <span class="n">newFont</span><span class="o">.</span><span class="n">toString</span><span class="p">())</span>
            <span class="c1"># add the font change to the apply queue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queueSetFont</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>

    <span class="nd">@queueStateChange</span><span class="p">(</span><span class="n">_verifyPopupApply</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_queueChangeGLFontSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">glFontSizeData</span><span class="o">.</span><span class="n">getText</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">GLFONT_DEFAULTSIZE</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">spectrumDisplayFontSize</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_changeGLFontSize</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_changeGLFontSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferences</span><span class="o">.</span><span class="n">appearance</span><span class="o">.</span><span class="n">spectrumDisplayFontSize</span> <span class="o">=</span> <span class="n">value</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ccpn.ui.gui.popups.PreferencesPopup</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>