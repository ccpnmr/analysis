
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite &#8212; Python  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../../_static/classic.css" />
    
    <script data-url_root="../../../../../../" id="documentation_options" src="../../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../../_static/jquery.js"></script>
    <script src="../../../../../../_static/underscore.js"></script>
    <script src="../../../../../../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Module Documentation here</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Licence, Reference and Credits</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright (C) CCPN project (http://www.ccpn.ac.uk) 2014 - 2017&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Wayne Boucher, Ed Brooksbank, Rasmus H Fogh, Luca Mureddu, Timothy J Ragan &amp; Geerten W Vuister&quot;</span><span class="p">)</span>
<span class="n">__licence__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;CCPN licence. See http://www.ccpn.ac.uk/v3-software/downloads/license&quot;</span><span class="p">,</span>
               <span class="s2">&quot;or ccpnmodel.ccpncore.memops.Credits.CcpnLicense for licence text&quot;</span><span class="p">)</span>
<span class="n">__reference__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;For publications, please use reference from http://www.ccpn.ac.uk/v3-software/downloads/license&quot;</span><span class="p">,</span>
               <span class="s2">&quot;or ccpnmodel.ccpncore.memops.Credits.CcpNmrReference&quot;</span><span class="p">)</span>

<span class="c1">#=========================================================================================</span>
<span class="c1"># Last code modification</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__modifiedBy__</span> <span class="o">=</span> <span class="s2">&quot;$modifiedBy: CCPN $&quot;</span>
<span class="n">__dateModified__</span> <span class="o">=</span> <span class="s2">&quot;$dateModified: 2017-07-07 16:33:25 +0100 (Fri, July 07, 2017) $&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: 3.0.0 $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Created</span>
<span class="c1">#=========================================================================================</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;$Author: CCPN $&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;$Date: 2017-04-07 10:28:48 +0000 (Fri, April 07, 2017) $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Start of code</span>
<span class="c1">#=========================================================================================</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">======================COPYRIGHT/LICENSE START==========================</span>

<span class="sd">XmlMapWrite.py: Code generation for CCPN framework</span>

<span class="sd">Copyright (C) 2005 Rasmus Fogh (CCPN Project)</span>

<span class="sd">=======================================================================</span>

<span class="sd">This library is free software; you can redistribute it and/or</span>
<span class="sd">modify it under the terms of the GNU General Public</span>
<span class="sd">License as published by the Free Software Foundation; either</span>
<span class="sd">version 2 of the License, or (at your option) any later version.</span>
<span class="sd"> </span>
<span class="sd">A copy of this license can be found in ../../../license/GPL.license</span>
<span class="sd"> </span>
<span class="sd">This library is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<span class="sd">General Public License for more details.</span>
<span class="sd"> </span>
<span class="sd">You should have received a copy of the GNU General Public</span>
<span class="sd">License along with this library; if not, write to the Free Software</span>
<span class="sd">Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>


<span class="sd">======================COPYRIGHT/LICENSE END============================</span>

<span class="sd">for further information, please contact :</span>

<span class="sd">- CCPN website (http://www.ccpn.ac.uk/)</span>

<span class="sd">- email: ccpn@bioc.cam.ac.uk</span>

<span class="sd">=======================================================================</span>

<span class="sd">If you are using this software for academic purposes, we suggest</span>
<span class="sd">quoting the following references:</span>

<span class="sd">===========================REFERENCE START=============================</span>
<span class="sd">R. Fogh, J. Ionides, E. Ulrich, W. Boucher, W. Vranken, J.P. Linge, M.</span>
<span class="sd">Habeck, W. Rieping, T.N. Bhat, J. Westbrook, K. Henrick, G. Gilliland,</span>
<span class="sd">H. Berman, J. Thornton, M. Nilges, J. Markley and E. Laue (2002). The</span>
<span class="sd">CCPN project: An interim report on a data model for the NMR community</span>
<span class="sd">(Progress report). Nature Struct. Biol. 9, 416-418.</span>

<span class="sd">Rasmus H. Fogh, Wayne Boucher, Wim F. Vranken, Anne</span>
<span class="sd">Pajon, Tim J. Stevens, T.N. Bhat, John Westbrook, John M.C. Ionides and</span>
<span class="sd">Ernest D. Laue (2005). A framework for scientific data modeling and automated</span>
<span class="sd">software development. Bioinformatics 21, 1678-1684.</span>

<span class="sd">===========================REFERENCE END===============================</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.metamodel</span> <span class="kn">import</span> <span class="n">MetaModel</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.metamodel</span> <span class="kn">import</span> <span class="n">Constants</span> <span class="k">as</span> <span class="n">metaConstants</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.scripts.core.LanguageInterface</span> <span class="kn">import</span> <span class="n">LanguageInterface</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.scripts.core.TypeInterface</span> <span class="kn">import</span> <span class="n">TypeInterface</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.metamodel.TextWriter</span> <span class="kn">import</span> <span class="n">TextWriter</span>
<span class="kn">from</span> <span class="nn">ccpnmodel.ccpncore.memops.format.xml.XmlGen</span> <span class="kn">import</span> <span class="n">XmlGen</span>

<span class="n">MemopsError</span> <span class="o">=</span> <span class="n">MetaModel</span><span class="o">.</span><span class="n">MemopsError</span>
<span class="n">headerTextTypeNames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Token&#39;</span><span class="p">,</span><span class="s1">&#39;Word&#39;</span><span class="p">]</span>

<span class="n">mandatoryAttributes</span> <span class="o">=</span> <span class="p">()</span>

<span class="n">repositoryTag</span> <span class="o">=</span> <span class="s1">&#39;$Name:  $&#39;</span>
<span class="n">repositoryId</span>  <span class="o">=</span> <span class="s1">&#39;$Id: XmlMapWrite.py,v 1.42.2.7 2010/06/14 11:21:33 jmci Exp $&#39;</span>


<div class="viewcode-block" id="XmlMapWrite"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite">[docs]</a><span class="k">class</span> <span class="nc">XmlMapWrite</span><span class="p">(</span><span class="n">LanguageInterface</span><span class="p">,</span> <span class="n">TypeInterface</span><span class="p">,</span> <span class="n">TextWriter</span><span class="p">,</span> <span class="n">XmlGen</span><span class="p">):</span>

  <span class="n">codeDirName</span> <span class="o">=</span> <span class="n">metaConstants</span><span class="o">.</span><span class="n">xmlCodeDir</span>
  
  <span class="n">localVarNames</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;globalMap&#39;</span><span class="p">:</span><span class="s1">&#39;globalMap&#39;</span><span class="p">,</span>
   <span class="s1">&#39;mapsByGuid&#39;</span><span class="p">:</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">,</span>
   <span class="s1">&#39;loadMaps&#39;</span><span class="p">:</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span>
   <span class="s1">&#39;abstractTypes&#39;</span><span class="p">:</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">,</span>
   <span class="s1">&#39;exolinks&#39;</span><span class="p">:</span><span class="s1">&#39;exolinks&#39;</span><span class="p">,</span>
   <span class="s1">&#39;currentMap&#39;</span><span class="p">:</span><span class="s1">&#39;currentMap&#39;</span><span class="p">,</span>
   <span class="s1">&#39;contentMap&#39;</span><span class="p">:</span><span class="s1">&#39;contentMap&#39;</span><span class="p">,</span>
   <span class="s1">&#39;aList&#39;</span><span class="p">:</span><span class="s1">&#39;aList&#39;</span><span class="p">,</span>
   <span class="s1">&#39;aDict&#39;</span><span class="p">:</span><span class="s1">&#39;aDict&#39;</span><span class="p">,</span>
  <span class="p">}</span>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    
    <span class="c1"># init handling</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">XmlMapWrite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">mandatoryAttributes</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot; XmlGen lacks mandatory </span><span class="si">%s</span><span class="s2"> attribute&quot;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementVarType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementVarType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementVarType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementVarType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementVarType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anyType</span><span class="p">)</span>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>

  <span class="c1"># overrides ModelTraverse</span>
<div class="viewcode-block" id="XmlMapWrite.processBranchPackage"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processBranchPackage">[docs]</a>  <span class="k">def</span> <span class="nf">processBranchPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; processing actions for branch package</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">packageDirName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObjDirName</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">package</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelPortal</span><span class="o">.</span><span class="n">twigPackages</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">clearOutDir</span><span class="p">(</span><span class="n">packageDirName</span><span class="p">)</span>
    
    <span class="c1"># must be called after</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">createDir</span><span class="p">(</span><span class="n">packageDirName</span><span class="p">)</span>
    
    <span class="nb">super</span><span class="p">(</span><span class="n">XmlMapWrite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">processBranchPackage</span><span class="p">(</span><span class="n">package</span><span class="p">)</span></div>
    
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processLeafPackage"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processLeafPackage">[docs]</a>  <span class="k">def</span> <span class="nf">processLeafPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">):</span>
  
    <span class="bp">self</span><span class="o">.</span><span class="n">setupLeafPackage</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">XmlMapWrite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">processLeafPackage</span><span class="p">(</span><span class="n">package</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>

  <span class="c1"># added for benefit of Java (originally was just in processLeafPackage)</span>
<div class="viewcode-block" id="XmlMapWrite.setupLeafPackage"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.setupLeafPackage">[docs]</a>  <span class="k">def</span> <span class="nf">setupLeafPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">):</span>
  
    <span class="n">globalMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;globalMap&#39;</span><span class="p">]</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">package</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">implPackage</span><span class="p">:</span>
      <span class="c1"># set up top level dicts</span>
      
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Set up global dictionaries&quot;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">ddName</span> <span class="ow">in</span>  <span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="s1">&#39;mapsByGuid&#39;</span><span class="p">):</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="n">ddName</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">globalMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ddName</span><span class="p">),</span> <span class="n">ss</span><span class="p">)</span>
      
      <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modelPortal</span><span class="o">.</span><span class="n">leafPackagesByImport</span><span class="p">():</span>
    
        <span class="n">pref</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">shortName</span>
        <span class="n">mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globalMap</span><span class="p">[</span><span class="n">pref</span><span class="p">]</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startBlock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2">: Set up top level dictionaries&quot;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="n">pref</span><span class="p">,</span> <span class="n">pp</span><span class="p">))</span>
 
        <span class="c1"># set up mapping and contained dicts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> 
                     <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">globalMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">pref</span><span class="p">),</span> <span class="n">currentMapVar</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ddName</span> <span class="ow">in</span>  <span class="p">(</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">,</span> <span class="s1">&#39;exolinks&#39;</span><span class="p">):</span>
          <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="n">ddName</span><span class="p">]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> <span class="n">ss</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.prefix&#39;</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">pref</span><span class="p">))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.qName&#39;</span><span class="p">),</span> 
                            <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="s1">&#39;.qName&#39;</span><span class="p">]))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.name&#39;</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ddName</span><span class="p">))</span>
 
        <span class="c1"># set top mapping parameters</span>
        <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;.prefix&#39;</span><span class="p">,</span> <span class="s1">&#39;.qName&#39;</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.name&#39;</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">))</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="s1">&#39;globalRelease&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mapping</span><span class="p">[</span><span class="n">ss</span><span class="p">])))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Set up top level dictionaries&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endBlock</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
    
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Set up top level dictionaries&quot;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">ddName</span> <span class="ow">in</span>  <span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="s1">&#39;mapsByGuid&#39;</span><span class="p">):</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">globalMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ddName</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="n">ddName</span><span class="p">],</span> 
                    <span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">ddName</span> <span class="ow">in</span>  <span class="p">(</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">,</span> <span class="s1">&#39;exolinks&#39;</span><span class="p">):</span>
      <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">globalMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">))</span>
      <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ddName</span><span class="p">))</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="n">ddName</span><span class="p">],</span> 
                  <span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.initLeafPackage"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.initLeafPackage">[docs]</a>  <span class="k">def</span> <span class="nf">initLeafPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; write API header for package containing actual code</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nb">super</span><span class="p">(</span><span class="n">XmlMapWrite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">initLeafPackage</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">openObjFile</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeFileHeader</span><span class="p">(</span><span class="n">package</span><span class="p">)</span></div>
    
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>

  <span class="c1"># overrides ModelTraverse</span>
<div class="viewcode-block" id="XmlMapWrite.endLeafPackage"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.endLeafPackage">[docs]</a>  <span class="k">def</span> <span class="nf">endLeafPackage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">):</span>
  
    <span class="nb">super</span><span class="p">(</span><span class="n">XmlMapWrite</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">endLeafPackage</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">closeFile</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processDataType"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processDataType">[docs]</a>  <span class="k">def</span> <span class="nf">processDataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;DataType </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="n">XmlGen</span><span class="o">.</span><span class="n">processDataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">processAbstractDataType</span><span class="p">(</span><span class="n">clazz</span><span class="p">)</span>
    
    <span class="c1"># add converters to and from string</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addXmlStringFunctions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> 
                               <span class="n">clazz</span><span class="o">.</span><span class="n">typeCodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">modelFlavours</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]])</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processDataObjType"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processDataObjType">[docs]</a>  <span class="k">def</span> <span class="nf">processDataObjType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;DataObjType </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="n">XmlGen</span><span class="o">.</span><span class="n">processDataObjType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">processAbstractDataType</span><span class="p">(</span><span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">addXmlClassCreation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> <span class="n">clazz</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processClass"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processClass">[docs]</a>  <span class="k">def</span> <span class="nf">processClass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Class </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
    <span class="n">XmlGen</span><span class="o">.</span><span class="n">processClass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">processAbstractDataType</span><span class="p">(</span><span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">addXmlClassCreation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> <span class="n">clazz</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
<div class="viewcode-block" id="XmlMapWrite.processAbstractDataType"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processAbstractDataType">[docs]</a>  <span class="k">def</span> <span class="nf">processAbstractDataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
    <span class="n">classMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globalMap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">][</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">][</span><span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
  
    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># add to top level dicts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">classMap</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">clazz</span><span class="o">.</span><span class="n">isAbstract</span><span class="p">:</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">],</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">classMap</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">tt</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">classMap</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span>
    
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;eType&#39;</span><span class="p">,</span> <span class="s1">&#39;fromParent&#39;</span><span class="p">,</span> <span class="s1">&#39;isTop&#39;</span><span class="p">,</span> <span class="s1">&#39;objkey&#39;</span><span class="p">,</span> <span class="s1">&#39;singleKid&#39;</span><span class="p">):</span>
      <span class="n">xx</span> <span class="o">=</span> <span class="n">classMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">xx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.endComplexDataType"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.endComplexDataType">[docs]</a>  <span class="k">def</span> <span class="nf">endComplexDataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">aList</span> <span class="o">=</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;aList&#39;</span><span class="p">]</span>
    <span class="n">contentMapVar</span> <span class="o">=</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;contentMap&#39;</span><span class="p">]</span>
    <span class="n">abstractTypes</span> <span class="o">=</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">]</span>
    <span class="n">classMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">globalMap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">][</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">][</span><span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
  
    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">contentMapVar</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> 
                      <span class="n">contentMapVar</span><span class="p">)</span>
    
    <span class="n">XmlGen</span><span class="o">.</span><span class="n">endComplexDataType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;End of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">startBlock</span><span class="p">()</span>
    <span class="n">cMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">abstractTypes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> <span class="n">cMap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;headerAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;simpleAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;optLinks&#39;</span><span class="p">,</span> <span class="s1">&#39;cplxAttrs&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;children&#39;</span><span class="p">):</span>
      <span class="n">initValues</span> <span class="o">=</span> <span class="n">classMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">initValues</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ss</span> <span class="o">==</span> <span class="s1">&#39;cplxAttrs&#39;</span><span class="p">:</span>
          <span class="c1"># then they appear in correct order in file</span>
          <span class="n">initValues</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="n">aList</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">initValues</span><span class="o">=</span><span class="n">initValues</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> <span class="n">aList</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endBlock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span></div>
    
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processAttribute"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processAttribute">[docs]</a>  <span class="k">def</span> <span class="nf">processAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">inClass</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
    
    <span class="n">result</span> <span class="o">=</span> <span class="n">XmlGen</span><span class="o">.</span><span class="n">processAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">inClass</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Attribute </span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inClass</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
      
      <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="n">inClass</span><span class="p">:</span>
        <span class="c1"># write map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processElement</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
 
        <span class="c1"># set default value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addDefaultValues</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span>
 
        <span class="c1"># add contents dict</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;attr&#39;</span><span class="p">:</span>
          <span class="c1"># simple type</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;guid&#39;</span><span class="p">]))</span>
          <span class="p">)</span>
 
        <span class="k">else</span><span class="p">:</span>
          <span class="c1"># result[&#39;type&#39;] == &#39;dobj&#39;</span>
          <span class="c1"># complex type</span>
          <span class="n">dd</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>
          <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;globalMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;.prefix&#39;</span><span class="p">]))</span>
          <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;.name&#39;</span><span class="p">]))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">ss</span><span class="p">)</span>
      
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># write reference to map</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;contentMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">ss</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="k">return</span> <span class="n">result</span></div>
    
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processRole"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processRole">[docs]</a>  <span class="k">def</span> <span class="nf">processRole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">inClass</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
    
    <span class="n">result</span> <span class="o">=</span> <span class="n">XmlGen</span><span class="o">.</span><span class="n">processRole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">inClass</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Role </span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inClass</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">elem</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
      
      <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="n">inClass</span><span class="p">:</span>
        <span class="c1"># write map</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">processElement</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;copyOverride&#39;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
          <span class="c1"># add copyOveride tag - used for subtree copying</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;copyOverride&#39;</span><span class="p">),</span> 
                            <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;copyOverride&#39;</span><span class="p">]))</span>
 
        <span class="c1"># add contents dict</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">!=</span> <span class="s1">&#39;link&#39;</span><span class="p">:</span>
          <span class="c1"># typ in (&#39;exotop&#39;, &#39;exolink&#39;, &#39;child&#39;)</span>
          <span class="n">dd</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span>
          <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;globalMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;.prefix&#39;</span><span class="p">]))</span>
          <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">dd</span><span class="p">[</span><span class="s1">&#39;.name&#39;</span><span class="p">]))</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span><span class="n">ss</span><span class="p">)</span>
          
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># write reference to map</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;contentMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">ss</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="k">return</span> <span class="n">result</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
<div class="viewcode-block" id="XmlMapWrite.processElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processElement">[docs]</a>  <span class="k">def</span> <span class="nf">processElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elemMap</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
      
    <span class="c1"># new dict</span>
    <span class="c1">#self.newDict(currentMapVar, keyType=self.stringVarType, needDeclType=True)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    
    <span class="c1"># add to top level dicts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;contentMap&#39;</span><span class="p">],</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    
    <span class="c1"># add parameters</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="s1">&#39;locard&#39;</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span>

    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;eType&#39;</span><span class="p">,</span> <span class="s1">&#39;proc&#39;</span><span class="p">,</span> <span class="s1">&#39;implSkip&#39;</span><span class="p">):</span>
      <span class="n">xx</span> <span class="o">=</span> <span class="n">elemMap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">xx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> 
                          <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span></div>
    
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># overrides XmlGen</span>
<div class="viewcode-block" id="XmlMapWrite.processExoLink"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.processExoLink">[docs]</a>  <span class="k">def</span> <span class="nf">processExoLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
    
    <span class="n">lv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span>
    <span class="n">currentMapVar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localVarNames</span><span class="p">[</span><span class="s1">&#39;currentMap&#39;</span><span class="p">]</span>
    
    <span class="n">elemMap</span> <span class="o">=</span> <span class="n">XmlGen</span><span class="o">.</span><span class="n">processExoLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Out-of-package link to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startBlock</span><span class="p">()</span>
      
    <span class="c1"># new dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># connect to toplevel dicts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;exolinks&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">clazz</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">],</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]),</span> <span class="n">currentMapVar</span><span class="p">)</span>
    
    <span class="c1"># add parameters</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;eType&#39;</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">elemMap</span><span class="p">[</span><span class="n">ss</span><span class="p">]))</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">addXmlClassCreation</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="n">clazz</span><span class="p">)</span>
    
    <span class="c1"># add keyMaps list                    </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;aList&#39;</span><span class="p">],</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="n">currentMapVar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;keyMaps&#39;</span><span class="p">),</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;aList&#39;</span><span class="p">])</span>
    
    <span class="k">for</span> <span class="n">km</span> <span class="ow">in</span> <span class="n">elemMap</span><span class="p">[</span><span class="s1">&#39;keyMaps&#39;</span><span class="p">]:</span>
    
      <span class="k">if</span> <span class="s1">&#39;tag&#39;</span> <span class="ow">in</span> <span class="n">km</span><span class="p">:</span>
        <span class="c1"># simple attribute - elemmap</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;mapsByGuid&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">km</span><span class="p">[</span><span class="s1">&#39;guid&#39;</span><span class="p">]))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># complex attribute or exolink - abstractTypes or exolinks dict</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">lv</span><span class="p">[</span><span class="s1">&#39;globalMap&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">km</span><span class="p">[</span><span class="s1">&#39;.prefix&#39;</span><span class="p">]))</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">km</span><span class="p">[</span><span class="s1">&#39;.name&#39;</span><span class="p">]))</span>
      
      <span class="c1"># add to list</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">lv</span><span class="p">[</span><span class="s1">&#39;aList&#39;</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endBlock</span><span class="p">()</span></div>
                      
  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
<div class="viewcode-block" id="XmlMapWrite.addXmlStringFunctions"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.addXmlStringFunctions">[docs]</a>  <span class="k">def</span> <span class="nf">addXmlStringFunctions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictName</span><span class="p">,</span> <span class="n">typeCode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Write info for conversion to and from string</span>
<span class="sd">    Must be overridden in subclasses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.addXmlStringFunctions must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
<div class="viewcode-block" id="XmlMapWrite.addDefaultValues"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.addDefaultValues">[docs]</a>  <span class="k">def</span> <span class="nf">addDefaultValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictName</span><span class="p">,</span> <span class="n">elemMap</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; write default values.</span>
<span class="sd">    NB individual languages may choose to skip some of the more difficult ones.</span>
<span class="sd">    The value is compared with the stored value in XmlIo, look there for </span>
<span class="sd">    exact format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.addDefaultValues must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
<div class="viewcode-block" id="XmlMapWrite.addXmlClassCreation"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.addXmlClassCreation">[docs]</a>  <span class="k">def</span> <span class="nf">addXmlClassCreation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictName</span><span class="p">,</span>  <span class="n">clazz</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Write info for creation of new class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.addXmlClassCreation must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.getSaveToStreamDocString"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.getSaveToStreamDocString">[docs]</a>  <span class="k">def</span> <span class="nf">getSaveToStreamDocString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Write topObject and its descendants to open stream &#39;stream&#39;.</span>

<span class="s2">&#39;mapping&#39; contains all XMLtag-Model and Model-XMLtag mapping info.</span>
<span class="s2">&#39;comment&#39; is added at the top of the file as an XML comment,</span>
<span class="s2">If &#39;simplified&#39; one-to-many links are written out at one end only,</span>
<span class="s2">(otherwise at both ends), and attributes equal to the default are skipped.</span>
<span class="s2">If &#39;compact&#39; most hicard==1 attributes are written as XML attributes of</span>
<span class="s2">the container, otherwise all attributes are written as elements.</span>
<span class="s2">If &#39;expanded&#39; all attributes are written with inside an explicit type</span>
<span class="s2">definition element (e.g. &lt;aSerial&gt;&lt;Int&gt;5&lt;/Int&gt;&lt;/aSerial&gt; instead of</span>
<span class="s2"> &lt;aSerial&gt;5&lt;/aSerial&gt;. Expanded form may be easier to do backwards</span>
<span class="s2"> compatibility in some rare cases.</span>
<span class="s2">&quot;&quot;&quot;</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeSaveToStream"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeSaveToStream">[docs]</a>  <span class="k">def</span> <span class="nf">writeSaveToStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">indentBySpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>

    <span class="n">apiDirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">metaConstants</span><span class="o">.</span><span class="n">apiCodeDir</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClass</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClass</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseDataVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseDataType</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRoot</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topObject</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="n">params</span><span class="o">=</span> <span class="p">((</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileInterfaceType</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">),</span> <span class="s1">&#39;output stream&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="s1">&#39;top object that is being saved&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;mapping which determines how to save (can be null)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="s1">&#39;comment to insert at top of file&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;simplified&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;whether output should be simplified&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;compact&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;whether output should be made compact&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;expanded&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;whether output should be expanded&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">)))</span>
    <span class="n">docString</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Write topObject and its descendants to open stream &#39;stream&#39;.</span>

<span class="s2">&#39;mapping&#39; contains all XMLtag-Model and Model-XMLtag mapping info.</span>
<span class="s2">&#39;comment&#39; is added at the top of the file as an XML comment,</span>
<span class="s2">If &#39;simplified&#39; one-to-many links are written out at one end only,</span>
<span class="s2">(otherwise at both ends), and attributes equal to the default are skipped.</span>
<span class="s2">If &#39;compact&#39; most hicard==1 attributes are written as XML attributes of</span>
<span class="s2">the container, otherwise all attributes are written as elements.</span>
<span class="s2">If &#39;expanded&#39; all attributes are written with inside an explicit type</span>
<span class="s2">definition element (e.g. &lt;aSerial&gt;&lt;Int&gt;5&lt;/Int&gt;&lt;/aSerial&gt; instead of</span>
<span class="s2"> &lt;aSerial&gt;5&lt;/aSerial&gt;. Expanded form may be easier to do backwards</span>
<span class="s2"> compatibility in some rare cases.</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartFunc</span><span class="p">(</span><span class="n">funcname</span><span class="o">=</span><span class="s1">&#39;saveToStream&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                         <span class="n">docString</span><span class="o">=</span><span class="n">docString</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeSaveToStreamBody</span><span class="p">(</span><span class="n">originator</span><span class="p">,</span> <span class="n">indentBySpaces</span><span class="o">=</span><span class="n">indentBySpaces</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endFunc</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeSaveToStreamBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeSaveToStreamBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeSaveToStreamBody</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">originator</span><span class="p">,</span> <span class="n">indentBySpaces</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>

    <span class="c1"># set up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set up&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;doComplex&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;simplified&#39;</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># check parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;compact&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;expanded&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s2">&quot;XML save: Parameters &#39;compact&#39; and &#39;expanded&#39; are incompatible&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># check for topObject</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check for topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;XML save: top obj is neither MemopsRoot nor TopObject&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># make sentinel objects</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;make sentinel objects&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;startObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;endObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;reuseList&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">initValues</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                       <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;emptyList&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set object ID dictionary</span>
    <span class="c1"># self.writeComment(&#39;set object ID dictionary&#39;)</span>
    <span class="c1"># self.setVar(&#39;nextID&#39;, 1, varType=self.intVarType)</span>
    <span class="c1"># self.newDict(&#39;classIDs&#39;, keyType=self.anyVarType, valueType=self.intVarType,</span>
    <span class="c1">#              needDeclType=True)</span>
    <span class="c1"># self.writeNewline()</span>

    <span class="c1"># set start indent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set start indent&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;indentBySpaces&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">indentBySpaces</span><span class="p">),</span> 
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;nIndent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;indent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="c1"># xml header</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="c1"># file comment</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteComment</span><span class="p">(</span><span class="s1">&#39;comment&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># start StorageUnit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">)),</span>
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;release&#39;</span><span class="p">,</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;globalRelease&#39;</span><span class="p">)),</span>
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentTime</span><span class="p">(),</span>
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;originator&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">originator</span><span class="p">),</span> 
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_StorageUnit&#39;</span><span class="p">),</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> 
                                 <span class="n">release</span><span class="o">=</span><span class="s1">&#39;release&#39;</span><span class="p">,</span> <span class="n">packageGuid</span><span class="o">=</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> 
                                 <span class="n">originator</span><span class="o">=</span><span class="s1">&#39;originator&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="c1"># Write objects</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Write objects&#39;</span><span class="p">)</span>
    <span class="c1"># self.printMessage(self.toLiteral(&#39;start generating output : &#39;),</span>
    <span class="c1">#  self.callFunc(&#39;getQualifiedName&#39;, &#39;topObject&#39;, doWrite=False)</span>
    <span class="c1"># )</span>

    <span class="c1"># new stacks: stack and mapStack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="n">initValues</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,),</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">initValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">),</span>
                        <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">initValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">initValue</span><span class="p">,</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
          <span class="c1">####castType=self.dictInterfaceType())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="n">initValues</span><span class="o">=</span><span class="p">(</span><span class="n">initValue</span><span class="p">,),</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># while stack is not empty</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startWhile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;curMap0&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 1&#39;</span><span class="p">)</span>
    <span class="c1"># if val is startObj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;startObj&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;start new attribute-less element&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NB we have been cheating, putting a string on the mapStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;curMap0&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamIndent</span><span class="p">(</span><span class="n">increasing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 1</span>
    <span class="c1"># else if val is endObj</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;endObj&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;end element&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NB we have been cheating, putting a string on the mapStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamIndent</span><span class="p">(</span><span class="n">increasing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteEndElement</span><span class="p">(</span><span class="s1">&#39;curMap0&#39;</span><span class="p">,</span> <span class="n">doIndent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 1</span>
    <span class="c1"># else (val is a real object)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="s1">&#39;curMap0&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)),</span> 
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 2&#39;</span><span class="p">)</span>
    <span class="c1"># if typ == &#39;simple&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;simple&#39;</span><span class="p">)))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamTextToString</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNonTextToString</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 2</span>
    <span class="c1"># else if typ == &#39;exo&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;exo&#39;</span><span class="p">)))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;endObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;keyMaps&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;keyMaps&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># put keys on stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;put keys on stack&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getFullKey&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIndexLoop</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenList</span><span class="p">(</span><span class="s1">&#39;keys&#39;</span><span class="p">),</span> <span class="n">isReversed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;keys&#39;</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>
    <span class="c1"># TBD: look at again when (if) have common superclass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">),</span>
     <span class="s1">&#39;or&#39;</span><span class="p">,</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseDataVarType</span><span class="p">),</span>
    <span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;keyMaps&#39;</span><span class="p">),</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="s1">&#39;ii&#39;</span><span class="p">,</span> <span class="s1">&#39;keyMaps&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIndexLoop</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Could be done directly&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;But it will not make much difference, so for consistency&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;startObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="c1"># IF BLOCK 2</span>
    <span class="c1"># else typ is class or cplx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;type class or cplx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># setup</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;stackVal&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;contDict&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;headerAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;optLinks&#39;</span><span class="p">,</span> <span class="s1">&#39;simpleAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;cplxAttrs&#39;</span><span class="p">):</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="n">ss</span><span class="p">),</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s1">&#39;emptyList&#39;</span><span class="p">)</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">),</span> <span class="n">tt</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;classtag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># put end-of-object marker on stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;put end-of-object marker on stack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;endObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;classtag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 3&#39;</span><span class="p">)</span>
    <span class="c1"># if typ == &#39;class&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)))</span>

    <span class="c1"># # get and write obj _ID</span>
    <span class="c1"># self.writeComment(&#39;get and write obj _ID&#39;)</span>
    <span class="c1"># self.setVar(&#39;_ID&#39;, self.getDictEntry(&#39;classIDs&#39;, &#39;val&#39;), varType=self.intVarType, castType=self.intVarType)</span>
    <span class="c1"># self.startIf(self.valueIsNone(&#39;_ID&#39;))</span>
    <span class="c1"># self.setVar(&#39;_ID&#39;, &#39;nextID&#39;)</span>
    <span class="c1"># self.setDictEntry(&#39;classIDs&#39;, &#39;val&#39;, &#39;_ID&#39;)</span>
    <span class="c1"># self.setVar(&#39;nextID&#39;, self.arithmetic(&#39;nextID&#39;, &#39;+&#39;, 1))</span>
    <span class="c1"># self.endIf()</span>
    <span class="c1"># self.writeNewline()</span>


    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;classtag&#39;</span><span class="p">,</span> <span class="n">closeElement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 3</span>
    <span class="c1"># else typ == &#39;cplx&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;typ == &#39;cplx&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;classtag&#39;</span><span class="p">,</span> <span class="n">closeElement</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="c1"># IF BLOCK 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 4</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 4&#39;</span><span class="p">)</span>
    <span class="c1"># if compact</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;compact&#39;</span><span class="p">)</span>
    <span class="c1"># set header attributes and links</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set header attributes and links&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectionIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;optLinks&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;doComplex&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">concatenateList</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;headerAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;optLinks&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="s1">&#39;headerAttrs&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># LOOP A</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;LOOP A&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;contDict&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;implSkip&#39;</span><span class="p">),</span>
               <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">continueLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># NB hicard is always 1 here</span>
    <span class="c1"># NB here we use name instead of tag, as tag is &#39;Clazz.attr&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NB hicard is always 1 here&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;NB here we use name instead of tag, as tag is &#39;Clazz.attr&#39;&quot;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">,</span> <span class="s1">&#39;stackVal&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 5</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 5&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">))</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 6</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 6&#39;</span><span class="p">)</span>
    <span class="c1"># if typ == &#39;link&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">)))</span>


    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;_ID&#39;&quot;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;_ID&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># self.setVar(&#39;_ID&#39;, self.getDictEntry(&#39;classIDs&#39;, &#39;value&#39;),</span>
    <span class="c1">#             varType=self.intVarType, castType=self.intVarType)</span>
    <span class="c1"># self.startIf(self.valueIsNone(&#39;_ID&#39;))</span>
    <span class="c1"># self.setVar(&#39;_ID&#39;, &#39;nextID&#39;)</span>
    <span class="c1"># self.setDictEntry(&#39;classIDs&#39;, &#39;value&#39;, &#39;_ID&#39;)</span>
    <span class="c1"># self.setVar(&#39;nextID&#39;, self.arithmetic(&#39;nextID&#39;, &#39;+&#39;, 1))</span>
    <span class="c1"># self.endIf()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteAttr</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;_ID&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 6</span>
    <span class="c1"># else typ == &#39;attr&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;typ == &#39;attr&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 7</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 7&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;doComplex&#39;</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">)),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNonTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteAttr</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 7</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 6</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 5</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># LOOP A</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 4</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 8</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 8&#39;</span><span class="p">)</span>
    <span class="c1"># class contains no XML elements. end immediately</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectionIsEmpty</span><span class="p">(</span><span class="s1">&#39;simpleAttrs&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
          <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectionIsEmpty</span><span class="p">(</span><span class="s1">&#39;cplxAttrs&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;compact&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;class contains no XML elements. end immediately&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 8</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="c1"># class may have more elements - process them</span>
    <span class="c1"># end start element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;class may have more elements - process them&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;end start element&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set indent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set indent&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamIndent</span><span class="p">(</span><span class="n">increasing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;compact&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="s1">&#39;simpleAttrs&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;doComplex&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">collectionIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;optLinks&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">concatenateList</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;headerAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;optLinks&#39;</span><span class="p">,</span> <span class="s1">&#39;simpleAttrs&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">concatenateList</span><span class="p">(</span><span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;headerAttrs&#39;</span><span class="p">,</span> <span class="s1">&#39;simpleAttrs&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># LOOP B</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;LOOP B&#39;</span><span class="p">)</span>
    <span class="c1"># set simple attributes and links</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set simple attributes and links&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;names&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;contDict&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;implSkip&#39;</span><span class="p">),</span>
               <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">continueLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 9</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 9&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">,</span> <span class="s1">&#39;stackVal&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">))</span>
    <span class="c1"># ss = self.comparison(&#39;val&#39;, &#39;!=&#39;, ss)</span>
    <span class="c1"># self.startIf(self.logicalOp(&#39;doComplex&#39;, &#39;or&#39;, ss))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;doComplex or (</span><span class="si">%s</span><span class="s1"> is None and val is not None) or val != </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">)))</span>
    <span class="c1"># put here in case of (future) types</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;put here in case of (future) types&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setByIndexInList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;reuseList&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;reuseList&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 10</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 10&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectionNotNoneAndNotEmpty</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="c1"># TBD: because have collectionInterfaceType here, startLoop function</span>
    <span class="c1"># calls below are passing bogus isUnique and isOrdered, could be set</span>
    <span class="c1"># (in Python and Java the isUnique and isOrdered arguments are ignored so ok for now)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectionInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 11</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 11&#39;</span><span class="p">)</span>
    <span class="c1"># if typ == &#39;link&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">newLine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># LOOP C</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;LOOP C&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;_ID&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;_ID&#39;&quot;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span>
                <span class="o">.</span><span class="n">intVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span><span class="p">)</span>

    <span class="c1"># self.setVar(&#39;_ID&#39;, self.getDictEntry(&#39;classIDs&#39;, &#39;value&#39;), varType=self.intVarType, castType=self.intVarType)</span>
    <span class="c1"># self.startIf(self.valueIsNone(&#39;_ID&#39;))</span>
    <span class="c1"># self.setVar(&#39;_ID&#39;, &#39;nextID&#39;)</span>
    <span class="c1"># self.setDictEntry(&#39;classIDs&#39;, &#39;value&#39;, &#39;_ID&#39;)</span>
    <span class="c1"># self.setVar(&#39;nextID&#39;, self.arithmetic(&#39;nextID&#39;, &#39;+&#39;, 1))</span>
    <span class="c1"># self.endIf()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteValue</span><span class="p">(</span><span class="s1">&#39;_ID&#39;</span><span class="p">)</span>

    <span class="c1"># LOOP C</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteEndElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 11</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;eType&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;expanded&#39;</span><span class="p">))</span>

    <span class="c1"># typ == &#39;attr&#39;, complex XML element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;typ == &#39;attr&#39;, complex XML element&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamIndent</span><span class="p">(</span><span class="n">increasing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tTag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteElement</span><span class="p">(</span><span class="s1">&#39;tTag&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNonTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteElement</span><span class="p">(</span><span class="s1">&#39;tTag&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamIndent</span><span class="p">(</span><span class="n">increasing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteEndElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">doIndent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 11</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="c1"># typ == &#39;attr&#39;, simple XML element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;typ == &#39;attr&#39;, simple XML element&quot;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;toStr&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">newLine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;toStr&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;vals&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNonTextToString</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteValue</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteEndElement</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span>


    <span class="c1"># IF BLOCK 11</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 10</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 9</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># LOOP B</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># put DataObjType attrs, exolinks, and child links on stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;put DataObjType attrs, exolinks, and child links on stack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># LOOP D</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;LOOP D&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;cplxAttrs&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">,</span> <span class="s1">&#39;stackVal&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 12</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 12&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueNotNoneAndIfListNotEmpty</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;contDict&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 13</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 13&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;implSkip&#39;</span><span class="p">),</span>
               <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;isImplementation&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tmpCont&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;endObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 14</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 14&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpCont&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 14</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamOrderedCollection</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 14</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="s1">&#39;startObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;mapStack&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 13</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 12</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># LOOP D</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 8</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endWhile</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&lt;/_StorageUnit&gt;</span><span class="se">\n</span><span class="s1">&lt;!--End of Memops Data--&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteStartElement</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">newLine</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamWriteEndElement</span><span class="p">(</span><span class="n">element</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamTextToString"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamTextToString">[docs]</a>  <span class="k">def</span> <span class="nf">streamTextToString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;String type&#39;</span><span class="p">)</span>
    <span class="n">vv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringReplace</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&amp;amp;&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringReplace</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&amp;quot;&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringReplace</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&amp;lt;&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringReplace</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;&amp;gt;&#39;</span><span class="p">)))</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWrite"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWrite">[docs]</a>  <span class="k">def</span> <span class="nf">streamWrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWrite must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteStartElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteStartElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteStartElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">closeElement</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">newLine</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWriteStartElement must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteEndElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteEndElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteEndElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">newLine</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">doIndent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWriteEndElement must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteAttr"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteAttr">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteAttr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWriteAttr must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteValue"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteValue">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWriteValue must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamWriteComment"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamWriteComment">[docs]</a>  <span class="k">def</span> <span class="nf">streamWriteComment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamWriteComment must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamNonTextToString"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamNonTextToString">[docs]</a>  <span class="k">def</span> <span class="nf">streamNonTextToString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamNonTextToString must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamIndent"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamIndent">[docs]</a>  <span class="k">def</span> <span class="nf">streamIndent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">increasing</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamIndent must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
 
  <span class="c1"># SaveToStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamOrderedCollection"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamOrderedCollection">[docs]</a>  <span class="k">def</span> <span class="nf">streamOrderedCollection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;XmlMapWrite.streamOrderedCollection must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStream"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStream">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>

    <span class="n">apiDirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">metaConstants</span><span class="o">.</span><span class="n">apiCodeDir</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClass</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClass</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baseDataVarType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImportName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseDataType</span><span class="p">,</span> <span class="n">subDirs</span><span class="o">=</span><span class="n">apiDirs</span><span class="p">)</span>

    <span class="n">params</span><span class="o">=</span> <span class="p">((</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileInterfaceType</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">),</span> <span class="s1">&#39;input stream&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;topObjId&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="s1">&#39;top object id&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="s1">&#39;top object&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;partialLoad&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">)))</span>
    <span class="n">docString</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;load Ccpn XML document using </span><span class="si">%s</span><span class="s2"> parser.</span>

<span class="s2">topObjId should be the guid (for objects with such an attribute),</span>
<span class="s2">otherwise the name (for objects with sucn an attribute), otherwise None.</span>
<span class="s2">It is meant to reflect the file name, for proper topObjects.</span>
<span class="s2">topObjId must match the guid/name.</span>

<span class="s2">topObject can be None, the memopsRoot, or a package TopObject.</span>
<span class="s2">If None the file must correspond to the Implementation package.</span>
<span class="s2">If memopsRoot the file must be from a non-Implementaiton package, and the</span>
<span class="s2">function will use the file to create a new TopObject under MemopsRoot.</span>
<span class="s2">If a package TopObject the function will read the data from the file</span>
<span class="s2">topObject into the passed-in TopObject, checking that the packages match,</span>
<span class="s2">and giving a warning if the topObject (pseudo)key changes.</span>
<span class="s2">  </span>
<span class="s2">if partialLoad is True only the TopObject (minus children) will be loaded</span>
<span class="s2">for normal packages. For the Implementation package Classes actually </span>
<span class="s2">in Implementation will be loaded while shell topObjectas and links to]</span>
<span class="s2">them will be skipped.</span>
<span class="s2">  </span>
<span class="s2">Conceivably the rules could later be relaxed to allow a lower-level empty</span>
<span class="s2">object  to be passed in for the purpose of reading subtrees. This would</span>
<span class="s2">require some code modifications.</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">parser</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartFunc</span><span class="p">(</span><span class="n">funcname</span><span class="o">=</span><span class="s1">&#39;loadFromStream&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                         <span class="n">docString</span><span class="o">=</span><span class="n">docString</span><span class="p">,</span> <span class="n">returnString</span><span class="o">=</span><span class="s1">&#39;the loaded topObject&#39;</span><span class="p">,</span>
                         <span class="n">returnType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>

    <span class="c1"># check for topObject</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check for topObject&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;XML load: top obj is neither MemopsRoot nor TopObject&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeLoadFromStreamStart</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeLoadFromStreamMain</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeLoadFromStreamHandleError</span><span class="p">()</span>
    <span class="c1"># self.reraiseException(exceptionClass=self.exceptionClass(&#39;ApiError&#39;))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">returnStatement</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endFunc</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeLoadFromStreamEnd</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># Expected that each of below will be overridden by implementations</span>
    <span class="c1"># by adding code at beginning and/or end</span>
    <span class="c1"># Problem is that some implementations use callbacks and some iterators</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartParse</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartElement</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamEndElement</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamEndParse</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamErrorBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamErrorBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamErrorBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># clean up in case of error.</span>
    <span class="c1"># Currently not done, as too hard to do properly. NBNB TBD</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;clean up in case of error.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Currently not done, as too hard to do properly. NBNB TBD&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getTopObject&#39;</span><span class="p">,</span> <span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isReading&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Error loading file for: &#39;</span><span class="p">),</span> <span class="s1">&#39;result&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Reading: &#39;</span><span class="p">),</span> <span class="s1">&#39;stream&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Last xml tag read: &#39;</span><span class="p">),</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Parser state was: &#39;</span><span class="p">),</span> <span class="s1">&#39;parserState&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Current object was: &#39;</span><span class="p">),</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Object stack was empty&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamExtraFunctions"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamExtraFunctions">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamExtraFunctions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeGetLoadingMaps</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeLinkChildData</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeDelayedLoadLinks</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamStartParse"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamStartParse">[docs]</a>  <span class="k">def</span> <span class="nf">streamStartParse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># do not want defines here because that should be done in implementation</span>
    <span class="c1"># if required (e.g. in Java these will be private variables so as to be</span>
    <span class="c1"># accessible across functions)</span>

    <span class="c1"># TBD: not sure these all have type anyVarType</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;crossLinkData&#39;</span><span class="p">,</span> <span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="c1">###self.defineVar(&#39;loadMaps&#39;, self.dictInterfaceType(self.stringVarType))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">valueType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">)</span>

    <span class="c1">## no longer below since MemopsDataTypeObject now using id(obj)</span>
    <span class="c1">## delayDataDict: ComplexDataType --&gt; (dd: string --&gt; list)</span>
    <span class="c1">##self.writeComment(&#39;delayDataDict: ComplexDataType --&gt; (dd: string --&gt; list)&#39;)</span>
    <span class="c1"># delayDataDict: AnyVarType --&gt; (dd: string --&gt; list)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;delayDataDict: AnyVarType --&gt; (dd: string --&gt; list)&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="c1">##self.newDict(&#39;delayDataDict&#39;, keyType=self.rootClassVarType, valueType=tt)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">valueType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="c1">###self.setVar(&#39;topObjectKey&#39;, self.toLiteral(None), varType=self.anyVarType)</span>
    <span class="c1">###self.setVar(&#39;parserState&#39;, self.toLiteral(&#39;starting&#39;), varType=self.stringVarType)</span>
    <span class="c1">###self.setVar(&#39;skipElement&#39;, self.toLiteral(None), varType=self.anyVarType)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parserState&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;starting&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;skipElement&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;foundClosingTag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;linkTopToParent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;earlyExit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;implPrefix&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;IMPL&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1">###self.setVar(&#39;result&#39;, self.toLiteral(None), varType=self.baseClassVarType)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamStartElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamStartElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamStartElement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># element start</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;element start&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamElementCheckSkip</span><span class="p">(</span><span class="n">doReset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementTag</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 102</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 102&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;file already started&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get map and test</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get map and test&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">(</span><span class="s1">&#39;KeyError&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;no map found for element&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Load maps not set up correctly - should not get here&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># check if we start skipping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check if we start skipping&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamElementSetSkip</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNextElement</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)),</span>
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 103</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 103&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsEmpty</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">))</span>

    <span class="c1"># inside _StorageUnit - preliminary check for TopObject element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;inside _StorageUnit - preliminary check for TopObject element&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;_StorageUnit has more than one child element&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 103</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 104</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 104&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;eType&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>

    <span class="c1"># start of class, complex attribute, collection or exolink</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;start of class, complex attribute, collection or exolink&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 105</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 105&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>

    <span class="c1"># class, or cplx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;class, or cplx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;clazz&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;constructor&#39;</span><span class="p">),</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s1">&#39;clazz&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;constructor&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 106</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 106&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 106</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 107</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 107&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">))</span>

    <span class="c1"># start of first topObject (passed in)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;start of first topObject (passed in)&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Non-empty stack at TopObject - should not get here&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 108</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 108&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">))</span>

    <span class="c1"># reading Implementation.xml</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;reading Implementation.xml&#39;</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.prefix&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;implPrefix&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamCallConstructor</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">,</span>
            <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="n">isReading</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;non-Implementation package called without TopObject&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;implPrefix&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    
    <span class="c1"># set to partialLod if this is a new version</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># get stored topObjId</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get stored topObjId&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementAttr</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 108</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 108&#39;</span><span class="p">)</span>
    <span class="c1"># topObject is MemopsRoot</span>
    <span class="c1"># reading new TopObject first time</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;topObject is MemopsRoot&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;reading new TopObject first time&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;linkTopToParent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.prefix&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;implPrefix&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Attempt to load into pre-existing MemopsRoot&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># non-impl package - create TopObject afresh</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;non-impl package - create TopObject afresh&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamCallConstructor</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span>
            <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="n">isReading</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectMap&#39;</span><span class="p">,</span> <span class="s1">&#39;curMap&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get stored topObjId</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get stored topObjId&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementAttr</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 108</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 108&#39;</span><span class="p">)</span>
    <span class="c1"># reading with pre-existing topObject - should fit mapping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;reading with pre-existing topObject - should fit mapping&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClass</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;clazz&#39;</span><span class="p">,</span> <span class="s1">&#39;is not&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;TopObject class does not fit first element class&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;clazz&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># check topObject status</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check topObject status&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isLoaded&#39;</span><span class="p">),</span>
                             <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;trying to load already loaded TopObject&#39;</span><span class="p">,</span> <span class="s1">&#39;topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isModified&#39;</span><span class="p">),</span>
                             <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;trying to load already modified TopObject&#39;</span><span class="p">,</span> <span class="s1">&#39;topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># check guid against topObj identifier</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check guid against topObj identifier&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementAttr</span><span class="p">(</span><span class="s1">&#39;idTag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;objId&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="s1">&#39;idTag&#39;</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;objId&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;elemId&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;TopObject identifier does not fit stored identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;objId&#39;</span><span class="p">,</span> <span class="s1">&#39;elemId&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set up for continuing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set up for continuing&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;topObject&#39;</span><span class="p">)</span>

    <span class="c1"># NB only MemopsRoot has fullKey None.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NB only MemopsRoot has fullKey None.&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getFullKey&#39;</span><span class="p">,</span> <span class="s1">&#39;topObject&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># TBD: isReading is implementation attribute, perhaps should have separate function for these</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isReading&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1"># IF BLOCK 108</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># check that file contents match file name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check that file contents match file name&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;topObjId&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;TopObject identifier does not fit passed=in identifier&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;elemId&#39;</span><span class="p">,</span> <span class="s1">&#39;topObjId&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># initialise with topObject</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;initialise with topObject&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    
    <span class="c1"># TBD: topObjByGuid is implementation dependent, should perhaps have separate function to get hold of this</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;memopsRoot&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getMemopsRoot&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;memopsRoot&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;memopsRoot&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;topObjects&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="c1"># self.streamSetupCompatibility()</span>

    <span class="c1"># IF BLOCK 107</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 107&#39;</span><span class="p">)</span>
    <span class="c1"># normal case - start of non-TopObject class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;normal case - start of non-TopObject class&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># make new class object</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;make new class object&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;objStackList&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamCallConstructor</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;objStackList&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;objStackList&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 107</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set delayDataDict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set delayDataDict&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">valueType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;objDelayDict&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 106</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 106&#39;</span><span class="p">)</span>

    <span class="c1"># start of complex datatype object</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;start of complex datatype object&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># make new dataObjType object</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;make new dataObjType object&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamCallConstructor</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">,</span>
            <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseDataVarType</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">)</span>
    
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDict</span><span class="p">(</span><span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">valueType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;objDelayDict&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 106</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 106&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Unknown element type&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 106</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># put obj on stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;put obj on stack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># treat XML attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;treat XML attributes&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;contMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="c1"># LOOP I</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;LOOP I&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartAttributeLoop</span><span class="p">(</span><span class="s1">&#39;tag2&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 110</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 110&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_ID&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;tag2&#39;</span><span class="p">))</span>

    <span class="c1"># Required to allow for old versions where ID start with &#39;_&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringSlice</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringSlice</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 110</span>
    <span class="c1"># self.elseIf()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;contMap&#39;</span><span class="p">,</span> <span class="s1">&#39;tag2&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">(</span><span class="s1">&#39;KeyError&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;no map found for XML attribute&#39;</span><span class="p">,</span> <span class="s1">&#39;tag2&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 111</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 111&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">))</span>
    <span class="c1"># TBD: ask Rasmus if valueIsNone is correct</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="n">tt</span><span class="p">))</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 112</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 112&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;delay&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
                           <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 112</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># types attr and text</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;types attr and text&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dataMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dataMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;cnvrt&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamConvertStringToValue</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 113</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 113&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;delay&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;objDelayDict&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 113</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="c1"># set, bypassing API</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set, bypassing API&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 113</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;tmpMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="c1"># always, except when cardinality has changed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;always, except when cardinality has changed&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 113</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="c1"># only when hicard has changed from 1 to something else</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;only when hicard has changed from 1 to something else&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="c1"># TBD: below will not work in Java as is because do not know whether</span>
    <span class="c1"># Set or List or even what type should be of the collection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 113</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 112</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 111</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 110</span>
    <span class="c1"># self.endIf()</span>

    <span class="c1"># LOOP I</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 105</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;child&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;is not&#39;</span><span class="p">,</span> <span class="s1">&#39;memopsRoot&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 105&#39;</span><span class="p">)</span>

    <span class="c1"># partially loading TopObject - end now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;partially loading TopObject - end now&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 109</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 109&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;topObjectMap&#39;</span><span class="p">))</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjectMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isTop&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="n">tt</span><span class="p">))</span>

    <span class="c1"># set TopObjects into TopObjects dictionary.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set TopObjects into TopObjects dictionary.&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;yy&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;earlyExit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamHaveEarlyExit</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 109</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># if we get here there was an error</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;if we get here there was an error&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s2">&quot;partial load with in incorrect context for &quot;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 105</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 105&#39;</span><span class="p">)</span>

    <span class="c1"># exolink, collection (of exo, cplx, or attr (e.g. text))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;exolink, collection (of exo, cplx, or attr (e.g. text))&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 105</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 104</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># no action for : &#39;simple&#39;.</span>
    <span class="c1"># Nor for &#39;attr&#39; or  &#39;link&#39; if eType != &#39;cplx&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;no action for : &#39;simple&#39;.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;Nor for &#39;attr&#39; or  &#39;link&#39; if eType != &#39;cplx&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 102</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 102&#39;</span><span class="p">)</span>

    <span class="c1"># no map - at start of file or error</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;no map - at start of file or error&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 114</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 114&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;starting&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;parserState&#39;</span><span class="p">))</span>

    <span class="c1"># IF BLOCK 115</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 115&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_StorageUnit&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">))</span>

    <span class="c1"># first element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;first element&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get version,  package, and updated mapping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get version,  package, and updated mapping&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementAttr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;release&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;fileVersion&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementAttr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;fileVersion&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s2">&quot;&lt;_StorageUnit element lacks &#39;release&#39; or &#39;packageGuid&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getLoadingMaps&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;fileVersion&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;lm&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;lm&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getByIndexInList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;lm&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># state tracker - for tests an error messages</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;state tracker - for tests an error messages&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parserState&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;reading&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 115</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s2">&quot;no &#39;_StorageUnit&#39; element found, or setup failed&quot;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 115</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 114</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Read past end of _StorageUnit&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 114</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 102</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamEndElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamEndElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamEndElement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># event == &#39;end&#39;, element end</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;event == &#39;end&#39;, element end&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamElementCheckSkip</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementTag</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_StorageUnit&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;foundClosingTag&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamFoundClosingTag</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">(</span><span class="s1">&#39;KeyError&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;no map found for element&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Load maps not set up correctly - should not get here&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 202</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 202&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">))</span>

    <span class="c1"># we are not yet finished</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;we are not yet finished&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;typ&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)),</span>
                <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 203&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;simple&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># DataType value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;DataType value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamElementText</span><span class="p">(),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;cnvrt&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamConvertStringToValue</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;child&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># child link</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;child link&#39;</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;loadDelayed&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>

    <span class="c1"># Special case:</span>
    <span class="c1"># premature link dereferencing.</span>
    <span class="c1"># necessary to handle Impl package properly</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Special case:&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;premature link dereferencing.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;necessary to handle Impl package properly&#39;</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;delayedLoadLinksStd&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">))</span>
    
    <span class="c1">#self.callFunc(&#39;delayedLoadLinks&#39;, params=(&#39;topObjByGuid&#39;, &#39;exoTopLinkData&#39;))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectionIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;ExoTopLinks should not exist at intermediate MemopsRoot link-up&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;linkChildData&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="s1">&#39;linkTopToParent&#39;</span><span class="p">,</span> <span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Reading MemopsRoot&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;and skipping everything to do with other packages&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;earlyExit&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamHaveEarlyExit</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="c1"># IF BLOCK 204</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 204&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isTop&#39;</span><span class="p">),</span>
                           <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>

    <span class="c1"># set TopObjects into TopObjects dictionary.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set TopObjects into TopObjects dictionary.&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topObjectVarType</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="s1">&#39;is not&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Read topObj with guid conflicts with existing topObj&#39;</span><span class="p">,</span> <span class="s1">&#39;guid&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 204</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">))</span>
    <span class="c1"># Rasmus 29/1/09 - remove useless empty dicts NBNB</span>
    <span class="c1"># NB delayDataDict is also used for backwards compatibility.</span>
    <span class="c1"># It should be possible to get the improvement also when upgrading,</span>
    <span class="c1"># but that would require debugging the compatibility scripts.</span>
    <span class="c1"># NBNB TODO  At the next major version upgrade this should be changed to plain self.elseIf()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">ss</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                            <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictIsEmpty</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">removeDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    
    <span class="c1"># IF BLOCK 204</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;exo&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># exolink</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;exolink&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lenList</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;lenxx&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 205</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 205&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;lenxx&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c1"># normal exoLink. Append curMap for later dereferencing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;normal exoLink. Append curMap for later dereferencing&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 205</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;lenxx&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c1"># link to TopObject. Must be handled differently, because</span>
    <span class="c1"># of toTopObject links that may be present in Implementation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;link to TopObject. Must be handled differently, because&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;of toTopObject links that may be present in Implementation&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getList</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 205</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;XML element appears empty&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 205</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># complex datatype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;complex datatype&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseDataVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamOverrideOff</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="c1"># Rasmus 29/1/09 - remove useless empty dicts NBNB</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">ss</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
                            <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictIsEmpty</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">removeDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># class elements - typ is &#39;link&#39;, &#39;attr&#39;, &#39;exolink&#39;, &#39;exotop&#39;, &#39;dobj&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s2">&quot;class elements - typ is &#39;link&#39;, &#39;attr&#39;, &#39;exolink&#39;, &#39;exotop&#39;, &#39;dobj&#39;&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get value&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>

    <span class="c1"># IF BLOCK 206</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 206&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;eType&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cplx&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="c1"># TBD is valueIsNone correct?</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectionIsEmpty</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
    <span class="c1"># NBNB with elements being skipped</span>
    <span class="c1"># this might legitimately happen during backwards compatibility</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NBNB with elements being skipped&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;this might legitimately happen during backwards compatibility&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNextElement</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 206</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;attr&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dataMap&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dataMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;cnvrt&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamElementSplitText</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;cnvrt&#39;</span><span class="p">)</span>

    <span class="c1"># check if non-empty</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check if non-empty&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectionIsEmpty</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;XML element appears empty&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 206</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamElementSplitText</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">)</span>

    <span class="c1"># check if non-empty</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;check if non-empty&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collectionIsEmpty</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;XML element appears empty&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 206</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set up&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;proc&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 207</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 207&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;delay&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;proc&#39;</span><span class="p">))</span>

    <span class="c1"># defunct element, preserved for backwards compatibility</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;defunct element, preserved for backwards compatibility&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;containerObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;dictid&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;containerObj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;containerObj&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dictid&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamObjDictKey</span><span class="p">(</span><span class="s1">&#39;containerObj&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dictid&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;dictid&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
                           <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 207</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># crosslink - delayed setting</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;crosslink - delayed setting&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 207</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;exotop&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>

    <span class="c1"># exolink to topObject. delayed setting</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;exolink to topObject. delayed setting&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 207</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># attribute for setting now</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;attribute for setting now&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;exolink&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">))</span>
    <span class="c1"># exolink not to topObject - convert to objects now.</span>
    <span class="c1"># val is topObjGuid, followed by rest of key,</span>
    <span class="c1"># followed by the exo link I/O map.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;exolink not to topObject - convert to objects now.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;val is topObjGuid, followed by rest of key,&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;followed by the exo link I/O map.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamConvertExolink</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># set up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set up&#39;</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># set value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set value&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">,</span> <span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 208</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 208&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(),</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getList</span><span class="p">(</span><span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;direct&#39;</span><span class="p">),</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="s1">&#39;proc&#39;</span><span class="p">))</span>
    <span class="c1"># set, bypassing API - hicard must be 1.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set, bypassing API - hicard must be 1.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="c1"># std set, hicard == 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;std set, hicard == 1&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 208</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>

    <span class="c1"># std set, hicard == infinity</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;std set, hicard == infinity&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 208</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># std set, hicard &gt; 1</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(),</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getListSlice</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="s1">&#39;hicard&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;stackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 208</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 207</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 203</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 202</span>
    <span class="c1"># TBD: should this be _StorageUnit</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;_StorageUnit&#39;</span><span class="p">),</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 202&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;objStack empty but element is not _StorageUnit&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 202</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamEndParse"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamEndParse">[docs]</a>  <span class="k">def</span> <span class="nf">streamEndParse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;earlyExit&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;foundClosingTag&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Premature end of file - no &lt;/_StorageUnit&gt; found&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;skipElement&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackSize</span><span class="p">(</span><span class="s1">&#39;objStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Illegal state after parsing: objStack length, skipElement&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;skipElement&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># delayed load</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;delayed load&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parserState&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;postprocessing data&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;memopsRoot&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;delayedLoadLinksStd&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;crossLinkData&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;delayedLoadLinksExo&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;topObjByGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;exoTopLinkData&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">)</span>
    <span class="c1"># backwards compatibility</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;backwards compatibility&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parserState&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;handling version compatibility&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamDoCompatibility</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># link children to parents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;link children to parents&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;linkChildData&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="s1">&#39;linkTopToParent&#39;</span><span class="p">,</span> <span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># validity check</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;validity check&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parserState&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;checking validity&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
 
    <span class="c1"># unset isReading (NB - extra link is for future load of non-topObjects)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;unset isReading (NB - extra link is for future load of non-topObjects)&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getTopObject&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;resultTop&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;resultTop&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isReading&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s1">&#39;partialLoad&#39;</span><span class="p">),</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> 
                  <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;memopsRoot&#39;</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;resultTop&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isLoaded&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    
    <span class="c1"># NBNB new addition set to modified if upgraded and modifieable</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;resultTop&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isModifiable&#39;</span><span class="p">),</span>
                             <span class="n">defaultValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">castVar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;resultTop&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isModified&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;topObjectKey&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logicalOp</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getFullKey&#39;</span><span class="p">,</span> <span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="c1"># self.startIf(self.comparison(&#39;topObjectKey&#39;, &#39;!=&#39;, &#39;xx&#39;))</span>
    <span class="c1"># self.printMessage(self.toLiteral(&#39;WARNING TopObject key changed on reading&#39;),</span>
    <span class="c1">#                   &#39;topObjectKey&#39;, &#39;xx&#39;)</span>
    <span class="c1"># self.endIf()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictValues</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">(</span><span class="s2">&quot;memopsRoot._upgradedFromV2&quot;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rootClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;checkValid&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
  <span class="c1"># internal function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementCheckSkip"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementCheckSkip">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementCheckSkip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doReset</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;skipElement&#39;</span><span class="p">))</span>
    <span class="c1"># we are skipping an element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;we are skipping an element&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">doReset</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">streamElementIsSkip</span><span class="p">())</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">streamElementSetSkip</span><span class="p">(</span><span class="n">setToNone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamNextElement</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeGetLoadingMaps"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeGetLoadingMaps">[docs]</a>  <span class="k">def</span> <span class="nf">writeGetLoadingMaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="n">params</span><span class="o">=</span> <span class="p">((</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="s1">&#39;package guid&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;fileVersion&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="s1">&#39;file version&#39;</span><span class="p">))</span>
    <span class="n">docString</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;returns (mapping, loadMaps, needCompatibility) tuple.</span>
<span class="s2">Allows for backwards compatibility</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartFunc</span><span class="p">(</span><span class="n">funcname</span><span class="o">=</span><span class="s1">&#39;getLoadingMaps&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                         <span class="n">docString</span><span class="o">=</span><span class="n">docString</span><span class="p">,</span> <span class="n">returnString</span><span class="o">=</span><span class="s1">&#39;the loading maps&#39;</span><span class="p">,</span>
                         <span class="n">returnType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeGetLoadingMapsBody</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">returnStatement</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endFunc</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeGetLoadingMapsBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeGetLoadingMapsBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeGetLoadingMapsBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamInitLoadingMaps</span><span class="p">()</span>

    <span class="c1"># select mapping for package</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;select mapping for package&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">())</span>

    <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictValues</span><span class="p">(</span><span class="s1">&#39;globalMapping&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;guid&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;packageGuid&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="s1">&#39;dd&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">breakLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;No package mapping with guid found&#39;</span><span class="p">,</span> <span class="s1">&#39;packageGuid&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;globalMapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;loadMaps&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;needCompatibility&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLinkChildData"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLinkChildData">[docs]</a>  <span class="k">def</span> <span class="nf">writeLinkChildData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="c1">## no longer below since using id(obj) for MemopsDataTypeObject</span>
    <span class="c1">##tt = self.dictInterfaceType(self.rootClassVarType, tt)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="n">params</span><span class="o">=</span> <span class="p">((</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;delay data dict&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="s1">&#39;top object&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span><span class="p">,</span> <span class="s1">&#39;package mapping&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;linkTopToParent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;link top to parent&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">)),</span>
             <span class="p">(</span><span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">booleanVarType</span><span class="p">,</span> <span class="s1">&#39;do out of package&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">)))</span>
    <span class="n">docString</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;set parent-child links.</span>
<span class="s2">delayDataDict is an obj/id:{childRoleName:listOfChildren}} dictionary</span>
<span class="s2">(it also contains other information used elsewhere for compatibility)</span>
<span class="s2">topObj is the TopObject</span>
<span class="s2">mapping is the package mapping</span>
<span class="s2">linkTopToParent determines if the root-to-topObject link must be set</span>
<span class="s2">doOutOfPackage determines if out-of-package children must be linked -</span>
<span class="s2">This is only relevant for the Implementation package, where first</span>
<span class="s2">intrapackge and later out-of-package children are set.</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamStartFunc</span><span class="p">(</span><span class="n">funcname</span><span class="o">=</span><span class="s1">&#39;linkChildData&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                         <span class="n">docString</span><span class="o">=</span><span class="n">docString</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeLinkChildDataBody</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endFunc</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLinkChildDataBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLinkChildDataBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeLinkChildDataBody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="c1"># set up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set up&#39;</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;mapping&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;abstractTypes&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dataTypeMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;topObj&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dataTypeMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;topObjMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># prime the stacks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;prime the stacks&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stackInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 301</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 301&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;linkTopToParent&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getParent&#39;</span><span class="p">,</span> <span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">initValues</span><span class="o">=</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> 
                  <span class="n">initValues</span><span class="o">=</span><span class="n">initValues</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="n">initValues</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ll&#39;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">,</span> 
                  <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">),</span> 
                  <span class="n">initValues</span><span class="o">=</span><span class="n">initValues</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 301</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="n">initValues</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;topObj&#39;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> 
                  <span class="n">initValues</span><span class="o">=</span><span class="n">initValues</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">initValues</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ll&#39;</span><span class="p">]</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newStack</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">initValues</span><span class="o">=</span><span class="n">initValues</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">),</span> 
                           <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamAddAll</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    
    <span class="c1"># IF BLOCK 301</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 302</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 302&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="s1">&#39;doOutOfPackage&#39;</span><span class="p">)</span>

    <span class="c1"># special case for TopObjects in Implementation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;special case for TopObjects in Implementation&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 303</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 303&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isInstance</span><span class="p">(</span><span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;topObjMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 304</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 304&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;linkMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 305</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 305&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;child&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;linkMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">))</span>

    <span class="c1"># child link</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;child link&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;linkMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;linkContent&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;obj2&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;linkContent&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 306</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 306&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isTop&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="n">tt</span><span class="p">))</span>

    <span class="c1"># TopObject. Do the link to parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;TopObject. Do the link to parent&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get key&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;objkey&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag2&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;tag2&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getLocalKey&#39;</span><span class="p">,</span> <span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="s1">&#39;tag2&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;fromParent&#39;</span><span class="p">),</span>
                           <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;topObj&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">getChildAsDict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># add child link to parent dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;add child link to parent dict&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyIsInDict</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">))</span>
    <span class="c1"># TBD: took off qualifiedName because only have two slots</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getQualifiedName&#39;</span><span class="p">,</span> <span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getParent&#39;</span><span class="p">,</span> <span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Cannot add child - key already in use&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;obj2&#39;</span><span class="p">)</span>
    <span class="c1"># NB these are shell TopObjects read in Implementation package</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;NB these are shell TopObjects read in Implementation package&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;isReading&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 306</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 305</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 304</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 303</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;linkChildData: called with doOutOfPackage for non-root&#39;</span><span class="p">,</span> <span class="s1">&#39;topObj&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 303</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 302</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># Normal case. Add children to parent dictionary</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;Normal case. Add children to parent dictionary&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startWhile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stackIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">,</span> <span class="s1">&#39;kids&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 307</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 307&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;kids&#39;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">popList</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;kids&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getClassname</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dataTypeMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">peekStack</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">,</span> <span class="s1">&#39;parentObj&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;fromParent&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;fromParent&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 308</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 308&#39;</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;singleKid&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="n">tt</span><span class="p">))</span>

    <span class="c1"># only child</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;only child&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;parentObj&#39;</span><span class="p">,</span> <span class="s1">&#39;fromParent&#39;</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;sibling&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;sibling&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;parentObj&#39;</span><span class="p">,</span> <span class="s1">&#39;fromParent&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Attempt to override single child&#39;</span><span class="p">,</span> <span class="s1">&#39;sibling&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 308</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;parentObj&#39;</span><span class="p">,</span> <span class="s1">&#39;fromParent&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">getChildAsDict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># get key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;get key&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;objkey&#39;</span><span class="p">))</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;tag&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getLocalKey&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">streamGetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;tag&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># add child link to parent dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;add child link to parent dict&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keyIsInDict</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">))</span>
    <span class="c1"># TBD: took off qualifiedName because only have two slots</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getQualifiedName&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getParent&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Cannot add child - key already in use&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDictEntry</span><span class="p">(</span><span class="s1">&#39;parDict&#39;</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 308</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># put children on stack</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pushStack</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">())</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;delayDataDict&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 309</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 309&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">))</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;children&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 310</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;IF BLOCK 310&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;tag2&#39;</span><span class="p">,</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;dd&#39;</span><span class="p">,</span> <span class="s1">&#39;tag2&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNotNone</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">streamAddAll</span><span class="p">(</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="s1">&#39;ll&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    <span class="c1"># IF BLOCK 310</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 309</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 307</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>

    <span class="c1"># no children left - go up a step</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;no children left - go up a step&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;childStack&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popStack</span><span class="p">(</span><span class="s1">&#39;parentStack&#39;</span><span class="p">)</span>

    <span class="c1"># IF BLOCK 307</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endWhile</span><span class="p">()</span>

    <span class="c1"># IF BLOCK 302</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeDelayedLoadLinks"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeDelayedLoadLinks">[docs]</a>  <span class="k">def</span> <span class="nf">writeDelayedLoadLinks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="n">params</span><span class="o">=</span> <span class="p">((</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(),</span> <span class="s1">&#39;object dict&#39;</span><span class="p">),</span>
             <span class="p">(</span><span class="s1">&#39;linkData&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">(),</span> <span class="s1">&#39;link data&#39;</span><span class="p">),)</span>
    <span class="n">docString</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Load single or multiple, </span><span class="si">%s</span><span class="s2">links</span>
<span class="s2">derefencing as you go using objectDict.</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">extraDoc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Std&#39;</span><span class="p">:</span><span class="s1">&#39;cross&#39;</span><span class="p">,</span> <span class="s1">&#39;Exo&#39;</span><span class="p">:</span><span class="s1">&#39;exo-to-TopObject&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;Std&#39;</span><span class="p">,</span> <span class="s1">&#39;Exo&#39;</span><span class="p">):</span>
    
      <span class="bp">self</span><span class="o">.</span><span class="n">streamStartFunc</span><span class="p">(</span><span class="n">funcname</span><span class="o">=</span><span class="s1">&#39;delayedLoadLinks</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                           <span class="n">docString</span><span class="o">=</span><span class="n">docString</span> <span class="o">%</span> <span class="n">extraDoc</span><span class="p">[</span><span class="n">tag</span><span class="p">])</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeDelayedLoadLinksBody</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endFunc</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeDelayedLoadLinksBody"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeDelayedLoadLinksBody">[docs]</a>  <span class="k">def</span> <span class="nf">writeDelayedLoadLinksBody</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">startWhile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collectionIsNotEmpty</span><span class="p">(</span><span class="s1">&#39;linkData&#39;</span><span class="p">,</span>
                                            <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1"># set up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">)</span>

    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popList</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="s1">&#39;linkData&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">listInterfaceType</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popList</span><span class="p">(</span><span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;linkData&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseClassVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">popList</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;linkData&#39;</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>

    <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">))</span>
    <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intVarType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">newList</span><span class="p">(</span><span class="s1">&#39;valueList&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">,</span> <span class="n">needDeclType</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

    <span class="c1"># map values</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;map values&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;Exo&#39;</span><span class="p">:</span>
      <span class="c1"># ExoTop version</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

      <span class="c1"># IF 2</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">valueIsNone</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">))</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;getRoot&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="n">doWrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dataRootVarType</span><span class="p">)</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictInterfaceType</span><span class="p">(</span><span class="n">keyType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;curMap&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">),</span>
                              <span class="n">castType</span><span class="o">=</span><span class="n">tt</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">tt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;.qName&#39;</span><span class="p">),</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;packageName&#39;</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">,</span> <span class="n">castType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stringVarType</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">callFunc</span><span class="p">(</span><span class="s1">&#39;refreshTopObjects&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;packageName&#39;</span><span class="p">,))</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
      <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Linked-to object with ID not found&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

      <span class="c1"># IF 2</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="s1">&#39;valueList&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>
    
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># std crosslink version</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">startLoop</span><span class="p">(</span><span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="n">isUnique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isOrdered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">startTry</span><span class="p">()</span>
      <span class="n">ss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDictEntry</span><span class="p">(</span><span class="s1">&#39;objectDict&#39;</span><span class="p">,</span> <span class="s1">&#39;vv&#39;</span><span class="p">,</span> <span class="n">keyIsMandatory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">addList</span><span class="p">(</span><span class="s1">&#39;oo&#39;</span><span class="p">,</span> <span class="s1">&#39;valueList&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">raiseApiError</span><span class="p">(</span><span class="s1">&#39;Linked-to object with ID not found&#39;</span><span class="p">,</span> <span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> 
                         <span class="s1">&#39;vv&#39;</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">writeNewline</span><span class="p">()</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">endLoop</span><span class="p">()</span>

    <span class="c1"># set element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">writeComment</span><span class="p">(</span><span class="s1">&#39;set element&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defineVar</span><span class="p">(</span><span class="s1">&#39;ov&#39;</span><span class="p">,</span> <span class="n">varType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">anyVarType</span><span class="p">)</span>

    <span class="c1"># IF 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">startIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">getList</span><span class="p">(</span><span class="s1">&#39;ov&#39;</span><span class="p">,</span> <span class="s1">&#39;valueList&#39;</span><span class="p">)</span>

    <span class="c1"># IF 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comparison</span><span class="p">(</span><span class="s1">&#39;hicard&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;ov&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getListSlice</span><span class="p">(</span><span class="s1">&#39;valueList&#39;</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="s1">&#39;hicard&#39;</span><span class="p">))</span>

    <span class="c1"># IF 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">elseIf</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVar</span><span class="p">(</span><span class="s1">&#39;ov&#39;</span><span class="p">,</span> <span class="s1">&#39;valueList&#39;</span><span class="p">)</span>

    <span class="c1"># IF 3</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endIf</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">streamSetValue</span><span class="p">(</span><span class="s1">&#39;obj&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;ov&#39;</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">endWhile</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">catchException</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;Error during </span><span class="si">%s</span><span class="s1"> link dereferencing. Object was: &#39;</span> <span class="o">%</span> <span class="n">tag</span><span class="p">),</span> 
     <span class="s1">&#39;obj&#39;</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;values were: &#39;</span><span class="p">),</span> <span class="s1">&#39;val&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">printMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toLiteral</span><span class="p">(</span><span class="s1">&#39;tag name was: &#39;</span><span class="p">),</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reraiseException</span><span class="p">(</span><span class="n">exceptionClass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exceptionClass</span><span class="p">(</span><span class="s1">&#39;ApiError&#39;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">endTry</span><span class="p">()</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamStart"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamStart">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamStart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamMain"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamMain">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamMain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamHandleError"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamHandleError">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamHandleError</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.writeLoadFromStreamEnd"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.writeLoadFromStreamEnd">[docs]</a>  <span class="k">def</span> <span class="nf">writeLoadFromStreamEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementTag"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementTag">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;start&#39;</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementText"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementText">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementSplitText"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementSplitText">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementSplitText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">cnvrt</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementAttr"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementAttr">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementAttr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementSetSkip"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementSetSkip">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementSetSkip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setToNone</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamElementIsSkip"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamElementIsSkip">[docs]</a>  <span class="k">def</span> <span class="nf">streamElementIsSkip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doReset</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamNextElement"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamNextElement">[docs]</a>  <span class="k">def</span> <span class="nf">streamNextElement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamStartAttributeLoop"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamStartAttributeLoop">[docs]</a>  <span class="k">def</span> <span class="nf">streamStartAttributeLoop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamGetValue"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamGetValue">[docs]</a>  <span class="k">def</span> <span class="nf">streamGetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">keyIsMandatory</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">getChildAsDict</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamSetValue"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamSetValue">[docs]</a>  <span class="k">def</span> <span class="nf">streamSetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">useDirectSet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamConvertStringToValue"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamConvertStringToValue">[docs]</a>  <span class="k">def</span> <span class="nf">streamConvertStringToValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cnvrt</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamOverrideOff"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamOverrideOff">[docs]</a>  <span class="k">def</span> <span class="nf">streamOverrideOff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamFoundClosingTag"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamFoundClosingTag">[docs]</a>  <span class="k">def</span> <span class="nf">streamFoundClosingTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamHaveEarlyExit"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamHaveEarlyExit">[docs]</a>  <span class="k">def</span> <span class="nf">streamHaveEarlyExit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamConvertExolink"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamConvertExolink">[docs]</a>  <span class="k">def</span> <span class="nf">streamConvertExolink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamCallConstructor"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamCallConstructor">[docs]</a>  <span class="k">def</span> <span class="nf">streamCallConstructor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">constructor</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">castType</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">attrlinks</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamAddAll"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamAddAll">[docs]</a>  <span class="k">def</span> <span class="nf">streamAddAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collectionToBeAdded</span><span class="p">,</span> <span class="n">collectionToBeAddedTo</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamObjDictKey"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamObjDictKey">[docs]</a>  <span class="k">def</span> <span class="nf">streamObjDictKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">isMetaClass</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamInitLoadingMaps"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamInitLoadingMaps">[docs]</a>  <span class="k">def</span> <span class="nf">streamInitLoadingMaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamDoCompatibility"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamDoCompatibility">[docs]</a>  <span class="k">def</span> <span class="nf">streamDoCompatibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># LoadFromStream function</span>
  <span class="c1"># def streamSetupCompatibility(self):</span>
  <span class="c1">#</span>
  <span class="c1">#   raise MemopsError(&quot;must be overridden&quot;)</span>

  <span class="c1">###########################################################################</span>

  <span class="c1">###########################################################################</span>
  
  <span class="c1"># SaveToStream function</span>
  <span class="c1"># LoadFromStream function</span>
<div class="viewcode-block" id="XmlMapWrite.streamStartFunc"><a class="viewcode-back" href="../../../../../../ccpnmodel/ccpnmodel.ccpncore.memops.scripts.xmlio.html#ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite.XmlMapWrite.streamStartFunc">[docs]</a>  <span class="k">def</span> <span class="nf">streamStartFunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">funcname</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">docString</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                      <span class="n">returnString</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">returnType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">throwsApiError</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="k">raise</span> <span class="n">MemopsError</span><span class="p">(</span><span class="s2">&quot;must be overridden&quot;</span><span class="p">)</span></div></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ccpnmodel.ccpncore.memops.scripts.xmlio.XmlMapWrite</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  </body>
</html>