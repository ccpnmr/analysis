<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AnalysisScreen Pipes</title>
    <link rel="stylesheet" href="CcpnVideoTutorials.css">
</head>
<body>
<div class="header"><a href="https://www.ccpn.ac.uk/"><img src="CCPN.png" alt="CCPN Logo" height="50"></a><a
        href="index.html" class="button">Video<br> Tutorials<br> & Manual</a><a href="https://forums.ccpn.ac.uk"><img
        src="CCPNForumLogo.png" alt="CCPN Logo" height="50" style="padding-left: 15px"></a></div>
<br>
<div class="headerBar">AnalysisScreen Pipes</div>
<div class="tutorial">

    <h2>AnalysisScreen Pipes</h2>
    <div class="sections"><a href="#annotatePeaks">Annotate Peaks</a> | <a href="#copyPeakLists">Copy PeakLists</a> | <a href="#excludeRegions">Exclude Regions</a> | <a href="#excludeSolvent">Exclude Solvent Regions</a> | <a href="#noiseThreshold">Noise Threshold</a> | <a href="#peakPicker1d">Peak Picker 1D</a> | <a href="#propagatePeaks">Propagate Peaks from References</a> | <a href="#figureOfMerit">Set Peak Figure of Merit</a> | <a href="#setUpScreening">Set up Screening Dataset</a> | <a href="#stdCreator">STD Creator</a>
    </div>

    <h3 id="annotatePeaks">Annotate Peaks</h3>
    <p>This will add an annotation into the <span class="action">Annotation</span> column of your peaks. The Annotation can either be the name of the Substance that the Spectrum is linked to (if the Spectra in the Input Data are Reference Spectra linked to Substances), or it can be the Name of the Spectrum.</p>
    <p>Note that the Annotation is one of the possible Peak Labels you can select to be shown in your Spectrum Displays.</p>
    <p>This pipe is typically used when picking Reference Singleton Spectra and is a means to transfer the information about the Substance or Spectrum to your Peaks.</p>

    <h3 id="copyPeakLists">Copy PeakLists</h3>
    <p>This will copy Peak Lists from a set of Spectra in one Spectrum Group to another, e.g. Reference to Control Spectra or Control to Target Spectra. You can choose whether to copy the peaks into a new peak list or use the last peak list, i.e. the one with the highest enumeration. You can also select whether to copy the peaks exactly as they are, whether the keep the position as it is, but recalculate the peak height based on the new spectrum or whether to snap the peaks to the best fit peak locally. If you choose to snap the peaks, you can specify a maximum distance by which a peak is allowed to move. <span class="action">Skp Below Merit</span> will not copy peaks with a Merit value of lower than that specified. Enable <span class="action">Snap to Neg Peaks</span> if you anticipate that your destination Spectrum may contain negative as well as positive peaks.</p>

    <h3 id="excludeRegions">Exclude Regions</h3>
    <p>This allows you to add one or more regions to be excluded in subsequent pipes. Specify the region either by entering the values directly or by clicking on the Target button and then dragging out the region interactively with the mouse in a Spectrum Display. Add or remove regions with the <span class="action">+</span> and <span class="action">-</span> buttons.</p>
    <p>This pipe works well in combination with the <span class="action">Peak Picker 1D</span> pipe.</p>

    <h3 id="excludeSolvent">Exclude Solvent Regions</h3>
    <p>This allows you to add regions to be excluded in subsequent pipes based on the position of common solvent peaks. Select one or more solvent areas to exclude and if you wish fine tune them by shanging the limits manually. You can also add a bespoke region by selecting <span class="action">New regions</span> and adding in the limits of your choice.</p>

    <h3 id="noiseThreshold">Noise Threshold</h3>
    <p>This allows you to set the noise threshold for your spectra. You can <span class="action">Estimate the Noise Threshold</span> automatically in which case you need to specify a <span class="action">Calibration region</span> (either set it manually in the boxes, or click on the target button to set it interactively with the mouse in a Spectrum Display). If you deselect <span class="action">Estimate the Noise Threshold</span> you can set the Noise Threshold manually, either by entering values into the boxes or by clicking on the target button to set it interactively with the mouse in a Spectrum Display.</p>
    <p>This pipe can be useful before using the <span class="action">Peak Picker 1D</span> pipe.</p>

    <h3 id="peakPicker1d">Peak Picker 1D</h3>
    <p>This will pick the peaks in the spectra in the Input Data section.</p>
    <p>Proceed with pipes such as <span class="action">Noise Threshold</span>, <span class="action">Exclude Regions</span> or <span class="action">Exclude Solvent Regions</span> to refine your pick picking. Follow with <span class="action">Refit Peaks</span> to estimate peak volumes at the same time.</p>

    <h3 id="propagatePeaks">Propagate Peaks from References</h3>
    <p>This will copy the peaks from multiple Singleton Reference Spectra into peaks lists of Substance mixtures (i.e. it will copy peaks from many peak lists into one, whereas the <span class="action">Copy PeakLists</span> pipe will copy one to one).</p>

    <h3 id="refitPeaks">Refit Peaks</h3>
    <p>This will refit all the peaks in the most recently created peak lists belonging to the spectra in the Input Data section. This is equivalent to using the <span class="action">RG</span> shortcut. Optionally you can estimate the volumes of your peaks at the same time.</p>
    <p>This can be a useful pipe to apply after picking peaks if you also want peak volumes (which are not calculated automatically when peaks are picked).</p>

    <h3 id="figureOfMerit">Set Peak Figure of Merit</h3>
    <p>This will automatically set the Merit of peaks with a Signal/Noise (S/N) ratio below a certain threshold to a specified value. Users can set both the S/N ratio threshold and the Merit value used.</p>
    <p>This pipe typically works well as a follow-on from the <span class="action">Peak Picker</span> or <span class="action">Copy PeakList</span> pipes.</p>

    <h3 id="setUpScreening">Set up Screening Dataset</h3>
    <p>This will create a new Screening Dataset which can be analysed in the <span class="action">Hit Analysis</span> module. It does so with automatic peak matching between the Reference, Control, Target and Displacer Spectra specified.
        <br>The <span class="action">Matching Engine</span> specifies the algorithm used for the peak matching. We have found that the <span class="action">Nearest Match</span> algorithm typically works better than the <span class="action">K-Means</span> or <span class="action">Dynamic Time Warping (DTW)</span> algorithms.
        <br>Note that the <span class="action">Reference SpectrumGroup</span> should only be specified if you are using Reference Mixtures. If you are using Reference Singleton spectra, leave <span class="action">Reference SpectrumGroup</span> blank and tick <span class="action">Use Substance Reference Spectra</span> instead.
        <br><span class="action">AutoScale Control-Target Spectra</span> will apply an automatic scaling factor to the Target spectra. This ensures that the intensity of Target Spectra peaks doesn't exceed that of the Control peaks. It is done on a Sample by Sample basis. The scaling accounts for variations in intensity that can occur due to sample dilution (e.g. after the target molecule has been added) or other experimental differences (changes in shimming etc.)</p>

    <h3 id="stdCreator">STD Creator</h3>
    <p>This will create a set of  difference spectra and place them into a new Spectrum Group. This is intended for use with STD spectra, thus the input SpectrumGroups requested are <span class="action">Off Resonance</span> and <span class="action">On Resonance</span>. The Off Resonance Spectrum is subtracted from the On Resonance Spectrum.</p>

</div>
</body>
</html>